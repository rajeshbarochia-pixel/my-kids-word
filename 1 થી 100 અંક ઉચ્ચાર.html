<!DOCTYPE html>
<html lang="gu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1 ркерлА 100 ркЧрлБркЬрк░рк╛ркдрлА ркЕркВркХрлЛркирлА рк░ркоркд - Created by : Rajesh Barochia</title>
    <!-- Tailwind CSS CDN --><script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ркХрк╕рлНркЯрко рк╕рлНркЯрк╛ркЗрк▓рк┐ркВркЧ ркЕркирлЗ рклрлЛркирлНркЯ (Noto Sans Gujarati ркирлЛ ркЙрккркпрлЛркЧ) */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Gujarati:wght=400;700&display=swap');
        body {
            font-family: 'Noto Sans Gujarati', sans-serif;
            background-color: #ffe0f6; /* рк╣рк│рк╡рлЛ ркЧрлБрк▓рк╛ркмрлА рк░ркВркЧ */
        }
        .number-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr); /* ркорлЛркмрк╛ркИрк▓ рккрк░ 5 ркХрлЛрк▓рко */
            gap: 8px;
        }
        @media (min-width: 640px) {
            .number-grid {
                grid-template-columns: repeat(10, 1fr); /* ркбрлЗрк╕рлНркХркЯрлЛркк/ркорлЛркЯрк╛ рк╕рлНркХрлНрк░рлАрки рккрк░ 10 ркХрлЛрк▓рко */
                gap: 12px;
            }
        }
        .number-tile {
            width: 100%;
            padding-top: 100%; /* ркЪрлЛрк░рк╕ ркЖркХрк╛рк░ ркЬрк╛рк│рк╡рк╡рк╛ ркорк╛ркЯрлЗ */
            position: relative;
            cursor: pointer;
            perspective: 1000px; /* 3D рклрлНрк▓рк┐ркк ркЕрк╕рк░ ркорк╛ркЯрлЗ */
        }
        
        /* рклрлНрк▓рк┐ркк ркХрк╛рк░рлНркб ркЗркирк░ (рк░рлЛркЯрлЗрк╢рки рк╣рлЗркирлНркбрк▓рк░) */
        .number-tile-inner {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            border-radius: 12px;
        }

        /* ркХрк╛рк░рлНркбркирлЗ ркКркВркзрлБркВ ркХрк░рк╡рк╛ ркорк╛ркЯрлЗ */
        .number-tile.is-flipped .number-tile-inner {
            transform: rotateY(180deg);
        }

        /* рк╕рк╛ркорк╛ркирлНркп ркЯрк╛ркЗрк▓ ркХркирлНркЯрлЗркирлНркЯ (ркЖркЧрк│ркирлА ркмрк╛ркЬрлБ) */
        .number-tile-front {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            font-weight: 700;
            border-radius: 12px;
            color: white;
            /* 3D ркорк╛ркВ рккрк╛ркЫрк│ркирлА ркмрк╛ркЬрлБ ркЫрлБрккрк╛рк╡рк╡рк╛ ркорк╛ркЯрлЗ */
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            transition: transform 0.1s; /* ркПркХрлНркЯрк┐рк╡ рк╕рлНркЯрлЗркЯ ркорк╛ркЯрлЗ ркЯрлНрк░рк╛ркирлНркЭрк┐рк╢рки */
        }
        
        /* ркЯрк╛ркЗрк▓ркирлА рккрк╛ркЫрк│ркирлА ркмрк╛ркЬрлБ */
        .number-tile-back {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #3b82f6; /* рк╡рк╛ркжрк│рлА рк░ркВркЧ */
            color: white;
            transform: rotateY(180deg); /* рк╢рк░рлВркЖркдркорк╛ркВ ркЫрлБрккрк╛рк╡рк╡рк╛ ркорк╛ркЯрлЗ */
            box-shadow: 0 4px #1d4ed8;
            font-size: 2rem;
            /* 3D ркорк╛ркВ рккрк╛ркЫрк│ркирлА ркмрк╛ркЬрлБ ркЫрлБрккрк╛рк╡рк╡рк╛ ркорк╛ркЯрлЗ */
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
        }
        
        /* ркЯркЪ ркХрк░рк╡рк╛ рккрк░ ркЯрк╛ркЗрк▓ркирлЗ ркирк╛ркирлА ркХрк░рк╡рк╛ ркЕркирлЗ рк╢рлЗркбрлЛ рк╣ркЯрк╛рк╡рк╡рк╛ ркорк╛ркЯрлЗ (рклрлНрк░ркирлНркЯ рк╕рк╛ркЗркб) */
        .number-tile:active .number-tile-front {
            transform: translateY(4px);
            box-shadow: 0 0 #d6499e;
        }

        /* ркХрлНрк▓рк┐ркХ ркХрк░рк╡рк╛ рккрк░ ркПркирк┐ркорлЗркЯрлЗркб ркЕрк╕рк░ */
        .number-tile.active-animate .number-tile-inner {
            animation: tile-pop 0.6s ease-out;
        }

        /* ркЯрк╛ркЗрк▓ ркорк╛ркЯрлЗ ркХрлАрклрлНрк░рлЗркорлНрк╕ (ркПркирк┐ркорлЗрк╢рки) */
        @keyframes tile-pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1) translateY(-5px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2); }
            100% { transform: scale(1); }
        }

        .gujarati-num {
            font-size: 2rem; /* ркЧрлБркЬрк░рк╛ркдрлА ркЕркВркХ */
            line-height: 1.2;
        }
        .loading-overlay {
            z-index: 10;
            background-color: rgba(255, 255, 255, 0.8);
        }
        /* рклрлВркЯрк░ ркорк╛ркЯрлЗ рк╕рлНркЯрк╛ркЗрк▓ */
        .creator-info {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #fce7f3; /* рк╣рк│рк╡рлЛ рккрлГрк╖рлНркаркнрлВркорк┐ рк░ркВркЧ */
            color: #9d174d;
            padding: 8px 0;
            text-align: center;
            font-size: 0.9rem;
            border-top: 2px solid #f9a8d4;
        }
    </style>
</head>
<body class="p-4 sm:p-8 min-h-screen">

    <div class="max-w-6xl mx-auto mb-16">
        <h1 class="text-4xl sm:text-5xl font-extrabold text-center mb-6 text-pink-700 leading-tight">
            ркЕркВркХрлЛркирлЛ ркЬрк╛ркжрлБ <span class="text-indigo-600"> (1-100)</span>
        </h1>
        <p class="text-center mb-4 text-lg text-pink-600">ркХрлЛркИрккркг ркЕркВркХ рккрк░ ркЯркЪ ркХрк░рлЛ, ркЕркирлЗ ркдрлЗркирлЛ ркЙркЪрлНркЪрк╛рк░ рк╕рк╛ркВркнрк│рлЛ! ркЯркЪ ркХрк░рк╡рк╛ркерлА ркХрк╛рк░рлНркб ркКркВркзрлБркВ ркеркИ ркЬрк╢рлЗ.</p>

        <!-- рк░рк┐рклрлНрк░рлЗрк╢ ркмркЯрки --><button id="refreshButton" class="w-full sm:w-auto px-6 py-3 mb-8 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105 mx-auto block">
            ркмркзрк╛ ркХрк╛рк░рлНркб рклрк░рлА ркЬрлБркУ (Refresh)
        </button>

        <!-- рк▓рлЛркбрк┐ркВркЧ рк╕рлНркЯрлЗркЯ ркорк╛ркЯрлЗ ркУрк╡рк░рк▓рлЗ --><div id="loadingOverlay" class="fixed inset-0 flex flex-col justify-center items-center loading-overlay">
            <div class="animate-spin rounded-full h-16 w-16 border-b-4 border-pink-500"></div>
            <!-- рккрлНрк░рлАрк▓рлЛркбрк┐ркВркЧ ркорлЗрк╕рлЗркЬ ркЕрккркбрлЗркЯ ркХрк░рлНркпрлЛ ркЫрлЗ --><p id="loadingMessage" class="mt-4 text-xl font-semibold text-pink-600">ркмркзрк╛ 100 ркЕркВркХрлЛркирлЛ ркСркбрк┐ркпрлЛ рк▓рлЛркб ркЕркирлЗ ркдрлИркпрк╛рк░ ркХрк░рлА рк░рк╣рлНркпрлБркВ ркЫрлЗ... ркХрлГрккрк╛ ркХрк░рлАркирлЗ рк░рк╛рк╣ ркЬрлБркУ.</p>
        </div>

        <div id="numberGrid" class="number-grid hidden">
            <!-- ркЕрк╣рлАркВ JavaScript ркжрлНрк╡рк╛рк░рк╛ ркиркВркмрк░рлЛ ркЙркорлЗрк░рк╡рк╛ркорк╛ркВ ркЖрк╡рк╢рлЗ --></div>

        <!-- ркСркбрк┐ркпрлЛ рккрлНрк▓рлЗркмрлЗркХ ркорк╛ркЯрлЗ ркПрк▓рк┐ркорлЗркирлНркЯ --><audio id="audioPlayer" preload="auto"></audio>

        <p id="errorBox" class="text-center mt-8 text-red-600 font-semibold hidden">
            ркСркбрк┐ркпрлЛ рк▓рлЛркб ркХрк░рк╡рк╛ркорк╛ркВ ркнрлВрк▓ ркЖрк╡рлА. ркХрлГрккрк╛ ркХрк░рлАркирлЗ рклрк░рлА рккрлНрк░ркпрк╛рк╕ ркХрк░рлЛ.
        </p>
    </div>

    <!-- ркХрлНрк░рк┐ркПркЯрк░ркирлБркВ ркирк╛рко рк╕рлНркХрлНрк░рлАрки рккрк░ ркирлАркЪрлЗ рклрлВркЯрк░ркорк╛ркВ ркЙркорлЗрк░рлНркпрлБркВ ркЫрлЗ --><div class="creator-info">
        Created by : Rajesh Barochia
    </div>

    <script>
        // рклрк╛ркпрк░ркмрлЗркЭ ркЕркирлЗ TTS ркорк╛ркЯрлЗ API ркХрлА ркЦрк╛рк▓рлА рк░рк╛ркЦрк╡рк╛ркорк╛ркВ ркЖрк╡рлЗ ркЫрлЗ, ркЬрлЗ рк░ркиркЯрк╛ркЗркоркорк╛ркВ рккрлВрк░рлА рккрк╛ркбрк╡рк╛ркорк╛ркВ ркЖрк╡рк╢рлЗ.
        const apiKey = "";
        const apiUrl = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent";

        // ркЧрлБркЬрк░рк╛ркдрлА ркЕркВркХрлЛ ркЕркирлЗ ркдрлЗркоркирк╛ ркирк╛ркоркирлЛ ркбрлЗркЯрк╛ (1 ркерлА 100)
        const gujaratiNumbersData = [
            { num: 1, guj: 'рлз', text: 'ркПркХ' }, { num: 2, guj: 'рли', text: 'ркмрлЗ' }, { num: 3, guj: 'рлй', text: 'ркдрлНрк░ркг' }, { num: 4, guj: 'рлк', text: 'ркЪрк╛рк░' }, { num: 5, guj: 'рлл', text: 'рккрк╛ркВркЪ' },
            { num: 6, guj: 'рлм', text: 'ркЫ' }, { num: 7, guj: 'рлн', text: 'рк╕рк╛ркд' }, { num: 8, guj: 'рло', text: 'ркЖрка' }, { num: 9, guj: 'рлп', text: 'ркирк╡' }, { num: 10, guj: 'рлзрлж', text: 'ркжрк╕' },
            { num: 11, guj: 'рлзрлз', text: 'ркЕркЧрк┐ркпрк╛рк░' }, { num: 12, guj: 'рлзрли', text: 'ркмрк╛рк░' }, { num: 13, guj: 'рлзрлй', text: 'ркдрлЗрк░' }, { num: 14, guj: 'рлзрлк', text: 'ркЪрлМркж' }, { num: 15, guj: 'рлзрлл', text: 'рккркВркжрк░' },
            { num: 16, guj: 'рлзрлм', text: 'рк╕рлЛрк│' }, { num: 17, guj: 'рлзрлн', text: 'рк╕ркдрлНркдрк░' }, { num: 18, guj: 'рлзрло', text: 'ркЕркврк╛рк░' }, { num: 19, guj: 'рлзрлп', text: 'ркУркЧркгрк┐рк╕' }, { num: 20, guj: 'рлирлж', text: 'рк╡рлАрк╕' },
            { num: 21, guj: 'рлирлз', text: 'ркПркХрк╡рлАрк╕' }, { num: 22, guj: 'рлирли', text: 'ркмрк╛рк╡рлАрк╕' }, { num: 23, guj: 'рлирлй', text: 'ркдрлНрк░рлЗрк╡рлАрк╕' }, { num: 24, guj: 'рлирлк', text: 'ркЪрлЛрк╡рлАрк╕' }, { num: 25, guj: 'рлирлл', text: 'рккркЪрлАрк╕' },
            { num: 26, guj: 'рлирлм', text: 'ркЫрк╡рлАрк╕' }, { num: 27, guj: 'рлирлн', text: 'рк╕рк┐ркдрлНркдрк╛рк╡рлАрк╕' }, { num: 28, guj: 'рлирло', text: 'ркИркарк╛рк╡рлАрк╕' }, { num: 29, guj: 'рлирлп', text: 'ркУркЧркгркдрлНрк░рлАрк╕' }, { num: 30, guj: 'рлйрлж', text: 'ркдрлНрк░рлАрк╕' },
            { num: 31, guj: 'рлйрлз', text: 'ркПркХркдрлНрк░рлАрк╕' }, { num: 32, guj: 'рлйрли', text: 'ркмркдрлНрк░рлАрк╕' }, { num: 33, guj: 'рлйрлй', text: 'ркдрлЗркдрлНрк░рлАрк╕' }, { num: 34, guj: 'рлйрлк', text: 'ркЪрлЛркдрлНрк░рлАрк╕' }, { num: 35, guj: 'рлйрлл', text: 'рккрк╛ркВркдрлНрк░рлАрк╕' },
            { num: 36, guj: 'рлйрлм', text: 'ркЫркдрлНрк░рлАрк╕' }, { num: 37, guj: 'рлйрлн', text: 'рк╕рк╛ркбркдрлНрк░рлАрк╕' }, { num: 38, guj: 'рлйрло', text: 'ркЖркбркдрлНрк░рлАрк╕' }, { num: 39, guj: 'рлйрлп', text: 'ркУркЧркгркЪрк╛рк▓рлАрк╕' }, { num: 40, guj: 'рлкрлж', text: 'ркЪрк╛рк▓рлАрк╕' },
            { num: 41, guj: 'рлкрлз', text: 'ркПркХркдрк╛рк▓рлАрк╕' }, { num: 42, guj: 'рлкрли', text: 'ркмрлЗркдрк╛рк▓рлАрк╕' }, { num: 43, guj: 'рлкрлй', text: 'ркдрлНркдрлЗркдрк╛рк▓рлАрк╕' }, { num: 44, guj: 'рлкрлк', text: 'ркЪрлБркорлНркорк╛рк▓рлАрк╕' }, { num: 45, guj: 'рлкрлл', text: 'рккрк┐рк╕рлНркдрк╛рк▓рлАрк╕' },
            { num: 46, guj: 'рлкрлм', text: 'ркЫрлЗркдрк╛рк▓рлАрк╕' }, { num: 47, guj: 'рлкрлн', text: 'рк╕рлБркбркдрк╛рк▓рлАрк╕' }, { num: 48, guj: 'рлкрло', text: 'ркЕркбркдрк╛рк▓рлАрк╕' }, { num: 49, guj: 'рлкрлп', text: 'ркУркЧркгрккркЪрк╛рк╕' }, { num: 50, guj: 'рллрлж', text: 'рккркЪрк╛рк╕' },
            { num: 51, guj: 'рллрлз', text: 'ркПркХрк╛рк╡рки' }, { num: 52, guj: 'рллрли', text: 'ркмрк╛рк╡рки' }, { num: 53, guj: 'рллрлй', text: 'ркдрлНрк░рлЗрккрки' }, { num: 54, guj: 'рллрлк', text: 'ркЪрлЛрккрки' }, { num: 55, guj: 'рллрлл', text: 'рккркВркЪрк╛рк╡рки' },
            { num: 56, guj: 'рллрлм', text: 'ркЫрккрлНрккрки' }, { num: 57, guj: 'рллрлн', text: 'рк╕ркдрлНркдрк╛рк╡рки' }, { num: 58, guj: 'рллрло', text: 'ркЕркарлНркарк╛рк╡рки' }, { num: 59, guj: 'рллрлп', text: 'ркУркЧркгрк╕рк╛ркИрка' }, { num: 60, guj: 'рлмрлж', text: 'рк╕рк╛ркИрка' },
            { num: 61, guj: 'рлмрлз', text: 'ркПркХрк╕рка' }, { num: 62, guj: 'рлмрли', text: 'ркмрк╛рк╕рка' }, { num: 63, guj: 'рлмрлй', text: 'ркдрлНрк░рлЗрк╕рка' }, { num: 64, guj: 'рлмрлк', text: 'ркЪрлЛрк╕рка' }, { num: 65, guj: 'рлмрлл', text: 'рккрк╛ркВрк╕рка' },
            { num: 66, guj: 'рлмрлм', text: 'ркЫрк╛рк╕рка' }, { num: 67, guj: 'рлмрлн', text: 'рк╕ркбрк╕рка' }, { num: 68, guj: 'рлмрло', text: 'ркЕркбрк╕рка' }, { num: 69, guj: 'рлмрлп', text: 'ркУркЧркгрк╕рк┐ркдрлНркдрлЗрк░' }, { num: 70, guj: 'рлнрлж', text: 'рк╕рк┐ркдрлНркдрлЗрк░' },
            { num: 71, guj: 'рлнрлз', text: 'ркПркХрлЛркдрлЗрк░' }, { num: 72, guj: 'рлнрли', text: 'ркмрлЛркВркдрлЗрк░' }, { num: 73, guj: 'рлнрлй', text: 'ркдрлЛркВркдрлЗрк░' }, { num: 74, guj: 'рлнрлк', text: 'ркЪрлВркорлЛркдрлЗрк░' }, { num: 75, guj: 'рлнрлл', text: 'рккркВркЪрлЛркдрлЗрк░' },
            { num: 76, guj: 'рлнрлм', text: 'ркЫрлЛркВркдрлЗрк░' }, { num: 77, guj: 'рлнрлн', text: 'рк╕рк┐ркдрлНркпрлЛркдрлЗрк░' }, { num: 78, guj: 'рлнрло', text: 'ркЗркарлНркпрлЛркдрлЗрк░' }, { num: 79, guj: 'рлнрлп', text: 'ркУркЧркгркПркВрк╕рлА' }, { num: 80, guj: 'рлорлж', text: 'ркПркВрк╕рлА' },
            { num: 81, guj: 'рлорлз', text: 'ркПркХрлНркпрк╛рк╕рлА' }, { num: 82, guj: 'рлорли', text: 'ркмрлНркпрк╛рк╕рлА' }, { num: 83, guj: 'рлорлй', text: 'ркдрлНркпрк╛рк╕рлА' }, { num: 84, guj: 'рлорлк', text: 'ркЪрлЛрк░рлНркпрк╛рк╕рлА' }, { num: 85, guj: 'рлорлл', text: 'рккркВркЪрк╛рк╕рлА' },
            { num: 86, guj: 'рлорлм', text: 'ркЫрлНркпрк╛рк╕рлА' }, { num: 87, guj: 'рлорлн', text: 'рк╕ркдрлНркпрк╛рк╕рлА' }, { num: 88, guj: 'рлорло', text: 'ркЕркарлНркпрк╛рк╕рлА' }, { num: 89, guj: 'рлорлп', text: 'ркирлЗрк╡рлНркпрк╛рк╕рлА' }, { num: 90, guj: 'рлпрлж', text: 'ркирлЗрк╡рлБркВ' },
            { num: 91, guj: 'рлпрлз', text: 'ркПркХрк╛ркгрлБркВ' }, { num: 92, guj: 'рлпрли', text: 'ркмрк╛ркгрлБркВ' }, { num: 93, guj: 'рлпрлй', text: 'ркдрлНрк░рк╛ркгрлБркВ' }, { num: 94, guj: 'рлпрлк', text: 'ркЪрлЛрк░рк╛ркгрлБркВ' }, { num: 95, guj: 'рлпрлл', text: 'рккркВркЪрк╛ркгрлБркВ' },
            { num: 96, guj: 'рлпрлм', text: 'ркЫркирлНркирлБркВ' }, { num: 97, guj: 'рлпрлн', text: 'рк╕ркдрлНркдрк╛ркгрлБркВ' }, { num: 98, guj: 'рлпрло', text: 'ркЕркарлНркарк╛ркгрлБркВ' }, { num: 99, guj: 'рлпрлп', text: 'ркирк╡рк╛ркгрлБркВ' }, { num: 100, guj: 'рлзрлжрлж', text: 'рк╕рлЛ' }
        ];

        // ркмрк╛рк│ркХрлЛркирлЗ ркЧркорлЗ ркдрлЗрк╡рк╛ рк╡рк┐рк╡рк┐ркз ркЗркорлЛркЬрлАркирлА ркпрк╛ркжрлА
        const emojis = ['ЁЯЪА', 'ЁЯМИ', 'тЬи', 'ЁЯМЯ', 'ЁЯОИ', 'ЁЯОЙ', 'ЁЯШК', 'ЁЯе│', 'ЁЯжД', 'тЭдя╕П', 'ЁЯжЛ', 'ЁЯР│', 'ЁЯНО', 'ЁЯНУ', 'тШАя╕П', 'ЁЯМЩ', 'тнР', 'ЁЯТп', 'тЬЕ', 'ЁЯО╢'];

        // ркСркбрк┐ркпрлЛ URL ркирлЗ ркХрлЗрк╢ ркХрк░рк╡рк╛ ркорк╛ркЯрлЗркирлБркВ ркСркмрлНркЬрлЗркХрлНркЯ
        const audioCache = {};

        const grid = document.getElementById('numberGrid');
        const audioPlayer = document.getElementById('audioPlayer');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const loadingMessage = document.getElementById('loadingMessage');
        const errorBox = document.getElementById('errorBox');
        const refreshButton = document.getElementById('refreshButton'); 

        let isAudioPlaying = false;
        let isAudioLoading = false;
        let isPreloadCompleted = false;

        // Base64 ркерлА ArrayBuffer ркорк╛ркВ ркХркирлНрк╡рк░рлНркЯ ркХрк░рк╡рк╛ ркорк╛ркЯрлЗркирлБркВ рклркВркХрлНрк╢рки
        const base64ToArrayBuffer = (base64) => {
            const binaryString = atob(base64);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes.buffer;
        };

        // PCM ркбрлЗркЯрк╛ркирлЗ WAV рклрлЛрк░рлНркорлЗркЯркорк╛ркВ ркХркирлНрк╡рк░рлНркЯ ркХрк░рк╡рк╛ ркорк╛ркЯрлЗркирлБркВ рклркВркХрлНрк╢рки
        const pcmToWav = (pcm16, sampleRate = 16000) => {
            const numChannels = 1;
            const bytesPerSample = 2; // Int16
            const blockAlign = numChannels * bytesPerSample;
            const byteRate = sampleRate * blockAlign;
            const dataSize = pcm16.length * bytesPerSample;
            const buffer = new ArrayBuffer(44 + dataSize);
            const view = new DataView(buffer);

            let offset = 0;
            const writeString = (str) => {
                for (let i = 0; i < str.length; i++) {
                    view.setUint8(offset + i, str.charCodeAt(i));
                }
                offset += str.length;
            };
            const writeUint32 = (val) => {
                view.setUint32(offset, val, true);
                offset += 4;
            };
            const writeUint16 = (val) => {
                view.setUint16(offset, val, true);
                offset += 2;
            };

            // RIFF chunk descriptor
            writeString('RIFF');
            writeUint32(36 + dataSize); // ChunkSize
            writeString('WAVE');

            // fmt sub-chunk
            writeString('fmt ');
            writeUint32(16); // Subchunk1Size
            writeUint16(1); // AudioFormat (1=PCM)
            writeUint16(numChannels); // NumChannels
            writeUint32(sampleRate); // SampleRate
            writeUint32(byteRate); // ByteRate
            writeUint16(blockAlign); // BlockAlign
            writeUint16(16); // BitsPerSample

            // data sub-chunk
            writeString('data');
            writeUint32(dataSize); // Subchunk2Size

            // Write PCM data
            for (let i = 0; i < pcm16.length; i++) {
                view.setInt16(offset, pcm16[i], true);
                offset += 2;
            }

            return new Blob([view], { type: 'audio/wav' });
        };


        // TTS API ркХрлЛрк▓ ркХрк░рлАркирлЗ ркСркбрк┐ркпрлЛ URL ркорлЗрк│рк╡рк╡рк╛ркирлБркВ рклркВркХрлНрк╢рки
        const fetchAndCreateAudioUrl = async (numberText) => {
            const payload = {
                contents: [{
                    parts: [{ text: `ркЧрлБркЬрк░рк╛ркдрлАркорк╛ркВ ркмрлЛрк▓рлЛ: ${numberText}` }] 
                }],
                generationConfig: {
                    responseModalities: ["AUDIO"],
                    speechConfig: {
                        voiceConfig: {
                            prebuiltVoiceConfig: { voiceName: "Leda" }
                        }
                    }
                },
                model: "gemini-2.5-flash-preview-tts"
            };

            const fullUrl = `${apiUrl}?key=${apiKey}`;
            const maxRetries = 3;

            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(fullUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    const part = result?.candidates?.[0]?.content?.parts?.[0];
                    const audioData = part?.inlineData?.data;
                    const mimeType = part?.inlineData?.mimeType;

                    if (audioData && mimeType && mimeType.startsWith("audio/")) {
                        const rateMatch = mimeType.match(/rate=(\d+)/);
                        const sampleRate = rateMatch ? parseInt(rateMatch[1], 10) : 16000;

                        const pcmData = base64ToArrayBuffer(audioData);
                        const pcm16 = new Int16Array(pcmData);
                        const wavBlob = pcmToWav(pcm16, sampleRate);
                        return URL.createObjectURL(wavBlob); // Object URL рккрк╛ркЫрлЛ ркЖрккрлЛ
                    } else {
                        throw new Error('Invalid audio data received from API.');
                    }
                } catch (error) {
                    if (i < maxRetries - 1) {
                        const delay = Math.pow(2, i) * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                    } else {
                        console.error(`Error generating audio for ${numberText}:`, error);
                        throw error; // ркЕркВркдрк┐рко ркнрлВрк▓ рклрлЗркВркХрлЛ
                    }
                }
            }
        };

        // ркмркзрк╛ 100 ркЕркВркХрлЛркирлЛ ркСркбрк┐ркпрлЛ рккрлНрк░рлАрк▓рлЛркб ркХрк░рлЛ
        const preloadAllAudio = async () => {
            isAudioLoading = true;
            refreshButton.disabled = true; // рккрлНрк░рлАрк▓рлЛркбрк┐ркВркЧ ркжрк░ркорк┐ркпрк╛рки ркмркЯрки ркирк┐рк╖рлНркХрлНрк░рк┐ркп ркХрк░рлЛ
            errorBox.classList.add('hidden');
            loadingOverlay.classList.remove('hidden');
            grid.classList.add('hidden'); // ркЧрлНрк░рлАркб ркЫрлБрккрк╛рк╡рлЛ

            const audioPromises = gujaratiNumbersData.map(async (item, index) => {
                loadingMessage.textContent = `ркСркбрк┐ркпрлЛ рк▓рлЛркб ркХрк░рлА рк░рк╣рлНркпрлБркВ ркЫрлЗ: ${index + 1} / ${gujaratiNumbersData.length}`;
                try {
                    const audioUrl = await fetchAndCreateAudioUrl(item.text);
                    audioCache[item.text] = audioUrl; // ркХрлЗрк╢ркорк╛ркВ URL рк╕рлНркЯрлЛрк░ ркХрк░рлЛ
                } catch (error) {
                    // ркЬрлЛ ркХрлЛркИ ркПркХ ркСркбрк┐ркпрлЛ рк▓рлЛркб рки ркерк╛ркп ркдрлЛ рккркг рккрлНрк░рлАрк▓рлЛркбрк┐ркВркЧ ркЪрк╛рк▓рлБ рк░рк╛ркЦрлЛ
                    audioCache[item.text] = null; // ркирк┐рк╖рлНрклрк│ркдрк╛ ркорк╛ркЯрлЗ null рк╕рлНркЯрлЛрк░ ркХрк░рлЛ
                    console.error(`Failed to preload audio for ${item.text}.`);
                }
            });

            try {
                // ркмркзрк╛ рккрлНрк░рлЛркорк┐рк╕ рккрлВрк░рлНркг ркерк╡рк╛ркирлА рк░рк╛рк╣ ркЬрлБркУ
                await Promise.all(audioPromises);
                isPreloadCompleted = true;
                loadingOverlay.classList.add('hidden');
                grid.classList.remove('hidden'); // ркЧрлНрк░рлАркб ркмркдрк╛рк╡рлЛ
                refreshButton.disabled = false; // ркмркЯрки рк╕ркХрлНрк░рк┐ркп ркХрк░рлЛ
                console.log('All 100 audio files preloaded successfully or failed gracefully.');
            } catch (finalError) {
                // ркЖ ркХрлЛркб ркмрлНрк▓рлЛркХ ркХрлНркпрк╛рк░рлЗркп рк╣рк┐ркЯ ркерк╡рлЛ ркЬрлЛркИркП ркирк╣рлАркВ ркХрк╛рк░ркг ркХрлЗ ркЕркорлЗ рккрлНрк░рлЛркорк┐рк╕ркирлЗ ркХрлЗркЪ ркХрк░рлА рк░рк╣рлНркпрк╛ ркЫрлАркП
                isPreloadCompleted = false;
                loadingOverlay.classList.add('hidden');
                errorBox.textContent = 'рккрлНрк░рк╛рк░ркВркнрк┐ркХ ркСркбрк┐ркпрлЛ рк▓рлЛркб ркХрк░рк╡рк╛ркорк╛ркВ ркЧркВркнрлАрк░ ркнрлВрк▓ ркЖрк╡рлА. ркХрлГрккрк╛ ркХрк░рлАркирлЗ рк░рлАрк▓рлЛркб ркХрк░рлЛ.';
                errorBox.classList.remove('hidden');
            } finally {
                isAudioLoading = false;
            }
        };


        // ркХрлЗрк╢ркорк╛ркВркерлА ркСркбрк┐ркпрлЛ рк▓ркИркирлЗ ркдрк░ркд рк╡ркЧрк╛ркбрк╡рк╛ркирлБркВ рклркВркХрлНрк╢рки
        const speakGujaratiNumber = async (numberText, tileElement) => {
            // ркЬрлЛ ркСркбрк┐ркпрлЛ рк╡рк╛ркЧркдрлЛ рк╣рлЛркп, ркдрлЛ ркмрлАркЬрлА рк╡рк┐ркиркВркдрлА ркЕрк╡ркЧркгрлЛ
            if (isAudioPlaying) return; 
            
            // ркЦрк╛ркдрк░рлА ркХрк░рлЛ ркХрлЗ рккрлНрк░рлАрк▓рлЛркбрк┐ркВркЧ рккрлВрк░рлНркг ркеркпрлБркВ ркЫрлЗ
            if (!isPreloadCompleted) {
                 // ркЖркжрк░рлНрк╢ рк░рлАркдрлЗ ркЖ ркерк╡рлБркВ рки ркЬрлЛркИркП, рккрк░ркВркдрлБ рк╕рлБрк░ркХрлНрк╖рк╛ ркорк╛ркЯрлЗ
                 errorBox.textContent = 'ркХрлГрккрк╛ ркХрк░рлАркирлЗ ркСркбрк┐ркпрлЛ рк╕ркВрккрлВрк░рлНркгрккркгрлЗ рк▓рлЛркб ркерк╛ркп ркдрлНркпрк╛ркВ рк╕рлБркзрлА рк░рк╛рк╣ ркЬрлБркУ.';
                 errorBox.classList.remove('hidden');
                 return;
            }

            // ркХрк╛рк░рлНркб рклрлНрк▓рк┐ркк ркХрк░рлЛ ркЕркирлЗ ркПркирк┐ркорлЗрк╢рки рк╢рк░рлВ ркХрк░рлЛ
            tileElement.classList.add('is-flipped');
            tileElement.classList.add('active-animate');
            
            const audioUrl = audioCache[numberText];

            if (!audioUrl) {
                // ркЬрлЛ ркСркбрк┐ркпрлЛ рккрлНрк░рлАрк▓рлЛркбрк┐ркВркЧ ркжрк░ркорк┐ркпрк╛рки ркирк┐рк╖рлНрклрк│ ркЧркпрлЛ рк╣рлЛркп
                console.error(`Audio for ${numberText} is missing in cache.`);
                errorBox.textContent = `${numberText} ркорк╛ркЯрлЗ ркСркбрк┐ркпрлЛ рккрлНрк▓рлЗркмрлЗркХ ркирк┐рк╖рлНрклрк│.`;
                errorBox.classList.remove('hidden');
                // ркерлЛркбрк╛ рк╕ркоркп рккркЫрлА ркПркирк┐ркорлЗрк╢рки ркжрлВрк░ ркХрк░рлЛ
                setTimeout(() => tileElement.classList.remove('active-animate'), 600);
                return;
            }
            
            // ркСркбрк┐ркпрлЛ рккрлНрк▓рлЗ ркХрк░рлЛ
            try {
                isAudioPlaying = true;
                grid.style.pointerEvents = 'none'; // ркЧрлНрк░рлАркбркирлЗ ркирк┐рк╖рлНркХрлНрк░рк┐ркп ркХрк░рлЛ
                refreshButton.disabled = true; // рк░рк┐рклрлНрк░рлЗрк╢ ркмркЯрки ркирк┐рк╖рлНркХрлНрк░рк┐ркп ркХрк░рлЛ

                audioPlayer.src = audioUrl;
                await audioPlayer.play();
                
                // ркСркбрк┐ркпрлЛ рк╕ркорк╛рккрлНркд ркеркпрк╛ рккркЫрлА рк╕рлНркЯрлЗркЯ рк░рлАрк╕рлЗркЯ ркХрк░рлЛ
                audioPlayer.onended = () => {
                    isAudioPlaying = false;
                    grid.style.pointerEvents = 'auto'; // ркЧрлНрк░рлАркбркирлЗ рк╕ркХрлНрк░рк┐ркп ркХрк░рлЛ
                    refreshButton.disabled = false; // рк░рк┐рклрлНрк░рлЗрк╢ ркмркЯрки рк╕ркХрлНрк░рк┐ркп ркХрк░рлЛ
                    tileElement.classList.remove('active-animate');
                    errorBox.classList.add('hidden');
                };
                audioPlayer.onerror = () => {
                    isAudioPlaying = false;
                    throw new Error('Audio playback error.');
                };

            } catch (error) {
                console.error('Playback failed:', error);
                isAudioPlaying = false;
                grid.style.pointerEvents = 'auto';
                refreshButton.disabled = false;
                tileElement.classList.remove('active-animate');
                errorBox.textContent = 'ркСркбрк┐ркпрлЛ рккрлНрк▓рлЗркмрлЗркХ ркнрлВрк▓.';
                errorBox.classList.remove('hidden');
            }
        };

        // ркмркзрк╛ ркХрк╛рк░рлНркбркирлЗ ркорлВрк│ рк╕рлНркерк┐ркдрк┐ркорк╛ркВ рккрк╛ркЫрк╛ рк▓рк╛рк╡рк╡рк╛ (ркЕрки-рклрлНрк▓рк┐ркк)
        const refreshGrid = () => {
            const flippedTiles = document.querySelectorAll('.number-tile.is-flipped');
            flippedTiles.forEach(tile => {
                tile.classList.remove('is-flipped');
            });
        };

        // ркмркзрк╛ ркиркВркмрк░ ркЯрк╛ркЗрк▓рлНрк╕ ркЬркирк░рлЗркЯ ркХрк░рлЛ
        const createNumberTiles = () => {
            grid.innerHTML = ''; // ркЦрк╛ркдрк░рлА ркХрк░рлЛ ркХрлЗ ркЧрлНрк░рлАркб ркЦрк╛рк▓рлА ркЫрлЗ
            gujaratiNumbersData.forEach(item => {
                const tile = document.createElement('div');
                tile.className = 'number-tile';
                tile.setAttribute('role', 'button');
                tile.setAttribute('aria-label', `ркЕркВркХ ${item.text}`);
                
                // ркСркбрк┐ркпрлЛ рк╣рк╡рлЗ ркХрлЗрк╢ркорк╛ркВркерлА ркЖрк╡рк╢рлЗ
                tile.onclick = () => speakGujaratiNumber(item.text, tile);

                const colorClasses = [
                    'bg-pink-500 shadow-[0_4px_#be185d]', 
                    'bg-blue-500 shadow-[0_4px_#2563eb]', 
                    'bg-green-500 shadow-[0_4px_#16a34a]', 
                    'bg-yellow-500 shadow-[0_4px_#ca8a04]',
                    'bg-indigo-500 shadow-[0_4px_#4f46e5]'
                ];
                const tileColor = colorClasses[item.num % colorClasses.length];
                
                // рк░рлЗркирлНркбрко ркЗркорлЛркЬрлА рккрк╕ркВркж ркХрк░рлЛ
                const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];

                // рклрлНрк▓рк┐ркк ркХрк╛рк░рлНркб ркорк╛ркЯрлЗ HTML рк╕рлНркЯрлНрк░ркХрлНркЪрк░
                tile.innerHTML = `
                    <div class="number-tile-inner">
                        <!-- FRONT SIDE (ркЖркЧрк│ркирлА ркмрк╛ркЬрлБ) --><div class="number-tile-front ${tileColor} hover:brightness-110 active:brightness-90 transition-all">
                            <span class="gujarati-num">${item.guj}</span>
                            <span class="text-sm mt-1 opacity-90">${item.text}</span>
                        </div>
                        <!-- BACK SIDE (рккрк╛ркЫрк│ркирлА ркмрк╛ркЬрлБ) --><div class="number-tile-back shadow-[0_4px_#1d4ed8]">
                            <span class="text-5xl">${randomEmoji}</span>
                        </div>
                    </div>
                `;
                grid.appendChild(tile);
            });
        };
        
        // рк░рк┐рклрлНрк░рлЗрк╢ ркмркЯрки рккрк░ ркХрлНрк▓рк┐ркХ ркЗрк╡рлЗркирлНркЯ ркЙркорлЗрк░рлЛ
        refreshButton.addEventListener('click', refreshGrid);

        // ркПрккрлНрк▓рк┐ркХрлЗрк╢рки рк╢рк░рлВ ркХрк░рлЛ: рккрк╣рлЗрк▓рк╛ рккрлНрк░рлАрк▓рлЛркб ркХрк░рлЛ, рккркЫрлА ркЯрк╛ркЗрк▓рлНрк╕ ркмркирк╛рк╡рлЛ
        window.onload = async () => {
            createNumberTiles(); // рккрк╣рлЗрк▓рк╛ ркЯрк╛ркЗрк▓рлНрк╕ ркмркирк╛рк╡рлЛ
            await preloadAllAudio(); // рккркЫрлА ркСркбрк┐ркпрлЛ рккрлНрк░рлАрк▓рлЛркб ркХрк░рлЛ
        };

    </script>
</body>
</html>