<!DOCTYPE html>
<html lang="gu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>àª®àª£àª•àª¾ àª—àª£àª¤àª°à«€àª¨à«€ àª°àª®àª¤ (àª“àªŸà«‹ àªšà«‡àª•)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the abacus structure and visual appeal */
        
        /* Setting the main body layout for full screen centering on desktop/tablet */
        .full-center-layout {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* Center content vertically on large screens */
            min-height: 100vh;
            padding: 1rem;
        }

        /* Base container for the Abacus visual */
        .abacus-base {
            background-color: #ffffff; /* White background for the abacus card */
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            width: 180px;
            margin: 0 auto;
            position: relative;
            z-index: 5;
        }

        .abacus-container-only {
            display: flex;
            justify-content: center;
            position: relative;
            height: 280px; /* HEIGHT INCREASED from 250px to 280px to contain all 9 beads */
            width: 160px; 
            margin: 0 auto; 
        }

        .rod-wrapper {
            position: absolute;
            bottom: 0;
            width: 50%; 
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: flex-end; 
            z-index: 10;
        }
        
        /* Rod Styling */
        .rod {
            width: 6px; 
            background-color: #555; 
            position: absolute; 
            bottom: 10px; 
            height: 250px; /* Rod height increased from 220px to 250px */
            border-radius: 3px;
        }

        .rod-tens-wrapper { left: 0; }
        .rod-units-wrapper { right: 0; }
        
        /* Bead Styling */
        .bead {
            width: 32px; /* Tappable size */
            height: 32px;
            border-radius: 50%;
            position: absolute;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3); 
            transition: bottom 0.5s ease-out; /* Use 'bottom' property for movement in this non-interactive mode */
            border: 2px solid rgba(255, 255, 255, 0.6);
            left: calc(50% - 16px); /* Center bead on the rod */
            z-index: 20;
        }

        /* Bead Colors - Using brighter colors */
        .color-0 { background-color: #fcd34d; /* Amber 300 */ }
        .color-1 { background-color: #ef4444; /* Red 500 */ }
        .color-2 { background-color: #2dd4bf; /* Teal 400 */ }
        .color-3 { background-color: #60a5fa; /* Blue 400 */ }
        .color-4 { background-color: #a78bfa; /* Violet 400 */ }
        .color-5 { background-color: #f472b6; /* Pink 400 */ }


        /* Input and Feedback */
        .answer-input {
            width: 120px; 
            height: 55px; 
            text-align: center;
            font-size: 1.8rem; 
            font-weight: bold;
            border: 3px solid #cbd5e1; /* Default border */
            border-radius: 12px; 
            outline: none;
            transition: border-color 0.3s, box-shadow 0.3s;
            background-color: #f8fafc; 
            color: #333;
        }
        .answer-input::placeholder {
            color: #94a3b8; 
            font-size: 1.0rem; /* FURTHER REDUCED FONT SIZE to 1.0rem */
        }
        .answer-input:focus {
            border-color: #6366f1; 
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.3); 
        }
        /* Color feedback styles */
        .answer-input.correct-border {
            border-color: #10b981; /* Green */
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.5); 
        }
        .answer-input.incorrect-border {
            border-color: #ef4444; /* Red */
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.5); 
        }

        .feedback-message {
            min-height: 40px; 
            padding: 8px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-100 to-red-100 min-h-screen p-4 flex flex-col items-center font-sans full-center-layout">

    <header class="text-center mb-8">
        <h1 class="text-4xl font-extrabold text-red-700 tracking-tight">àª®àª£àª•àª¾ àª—àª£à«‹</h1>
        <p class="text-lg text-gray-700 mt-2">àª®àª£àª•àª¾ àª˜à«‹àª¡à«€àª®àª¾àª‚ àª®àª£àª•àª¾ àª—àª£à«€àª¨à«‡ àª¸àª¾àªšà«€ àª¸àª‚àª–à«àª¯àª¾ àª²àª–à«‹.</p>
        <p class="text-sm text-gray-500 mt-1">Created by: Rajesh Barochia</p> <!-- Added Creator Name Here -->
    </header>

    <div id="game-area" class="w-full max-w-sm flex flex-col items-center">
        <!-- Abacus and Input will be injected here -->
    </div>
    
    <div class="mt-8 w-full max-w-sm flex justify-center">
        <button id="new-game-btn" onclick="generateNewGame(1)" class="px-6 py-3 bg-indigo-600 text-white font-semibold rounded-xl shadow-lg hover:bg-indigo-700 transition transform hover:scale-105 active:scale-95 text-lg">
            àª¨àªµà«‹ àªªà«àª°àª¶à«àª¨ àª²àª¾àªµà«‹ (New Question)
        </button>
    </div>

    <div id="score-message" class="mt-8 p-4 w-full max-w-sm text-center text-xl font-bold rounded-xl hidden text-green-700 bg-green-100"></div>

    <script>
        const BEAD_COLORS = ['color-0', 'color-1', 'color-2', 'color-3', 'color-4', 'color-5'];
        const BEAD_HEIGHT = 32; // Bead diameter
        const BEAD_GAP = 2;     // Small gap between beads
        const TOTAL_BEAD_SIZE = BEAD_HEIGHT + BEAD_GAP;
        const ROD_BOTTOM_OFFSET = 10; 
        const MAX_BEADS_PER_ROD = 9; 

        let correctAnswers = [];
        let isAnsweredCorrectly = false; // Flag to prevent repeated actions on the same correct answer

        // Helper function to generate a random integer
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        /**
         * Renders the bead elements for a single rod, stacked from the bottom.
         * @param {number} count The number of beads to display.
         * @param {string} colorClass The color class for the beads.
         * @returns {string} The HTML string for the beads.
         */
        function generateBeads(count, colorClass) {
            let beadsHTML = '';
            // We want 'count' beads to be visible at the bottom of the rod.
            // Since the Abacus is read from bottom up, we generate only the required beads.
            for (let i = 0; i < count; i++) {
                // Calculate 'bottom' position to stack beads correctly on the rod
                const bottomPosition = ROD_BOTTOM_OFFSET + (i * TOTAL_BEAD_SIZE); 
                beadsHTML += `<div class="bead ${colorClass}" style="bottom: ${bottomPosition}px;"></div>`;
            }
            return beadsHTML;
        }


        /**
         * Generates the HTML for one single abacus problem.
         * @param {number} number The number to be displayed (e.g., 35).
         * @param {number} index The index of this problem in the game (always 0).
         * @returns {string} The HTML string for the problem.
         */
        function createAbacusProblem(number, index) {
            const unitsDigit = number % 10; // àªàª•àª® (Units)
            const tensDigit = Math.floor(number / 10); // àª¦àª¶àª• (Tens)

            // Ensure different colors for units and tens for better visibility
            let unitsBeadColor = BEAD_COLORS[getRandomInt(0, BEAD_COLORS.length - 1)];
            let tensBeadColor = unitsBeadColor;
            while(tensBeadColor === unitsBeadColor) {
                 tensBeadColor = BEAD_COLORS[getRandomInt(0, BEAD_COLORS.length - 1)];
            }
            
            return `
                <div class="flex flex-col items-center">
                    <div class="abacus-base">
                        <div class="abacus-container-only">
                            
                            <!-- Tens Rod Area -->
                            <div class="rod-wrapper rod-tens-wrapper">
                                <div class="rod"></div>
                                <div class="absolute w-full h-full">
                                    ${generateBeads(tensDigit, tensBeadColor)}
                                </div>
                            </div>

                            <!-- Units Rod Area -->
                            <div class="rod-wrapper rod-units-wrapper">
                                <div class="rod"></div>
                                <div class="absolute w-full h-full">
                                    ${generateBeads(unitsDigit, unitsBeadColor)}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex flex-col items-center w-full mt-6">
                        <input 
                            type="number" 
                            id="input-${index}" 
                            data-index="${index}" 
                            class="answer-input" 
                            placeholder="àª¸àª‚àª–à«àª¯àª¾ àª²àª–à«‹"
                            min="0" max="99"
                            oninput="checkImmediateAnswer(this)"
                        >
                        <div id="feedback-${index}" class="mt-3 feedback-message"></div>
                    </div>
                </div>
            `;
        }

        /**
         * Checks the user's answer immediately on input and provides color feedback.
         * @param {HTMLInputElement} inputElement The input field that triggered the event.
         */
        function checkImmediateAnswer(inputElement) {
            const index = 0; // Fixed index since there is only one question
            const feedbackEl = document.getElementById(`feedback-${index}`);
            const correctAns = correctAnswers[index];
            const userAnswer = parseInt(inputElement.value);

            // 1. Clear previous classes
            inputElement.classList.remove('correct-border', 'incorrect-border');
            feedbackEl.textContent = '';
            feedbackEl.classList.remove('text-red-600', 'text-green-600');
            document.getElementById('score-message').classList.add('hidden');

            // If input is empty or NaN, just clear feedback and return
            if (isNaN(userAnswer) || inputElement.value.length === 0) {
                isAnsweredCorrectly = false;
                return;
            }

            // Convert correct answer to string to compare length (for two digits check)
            const correctAnsStr = String(correctAns);
            const userAnsStr = inputElement.value;
            
            // Check if the answer is correct
            if (userAnswer === correctAns) {
                if (!isAnsweredCorrectly) {
                    isAnsweredCorrectly = true;
                    
                    // Correct feedback: Green border
                    inputElement.classList.add('correct-border');
                    inputElement.readOnly = true; // Lock input
                    feedbackEl.textContent = 'àª¸àª¾àªšà«àª‚! âœ…';
                    feedbackEl.classList.add('text-green-600');

                    // Show success message briefly
                    const scoreMessageEl = document.getElementById('score-message');
                    scoreMessageEl.classList.remove('hidden');
                    scoreMessageEl.innerHTML = `àª¬àª¹à« àª¸àª°àª¸! ğŸ‰ àª¤àª®àª¾àª°à«‹ àªœàªµàª¾àª¬ àª¸àª¾àªšà«‹ àª›à«‡.`;
                    
                    // Automatically generate new game after a short delay
                    setTimeout(() => {
                        generateNewGame(1);
                    }, 2000); // 2 second delay
                }
            } else if (userAnsStr.length === correctAnsStr.length) {
                // If the user entered the full number of digits (usually 2 for 10-99) but it's wrong: Red border
                inputElement.classList.add('incorrect-border');
                feedbackEl.textContent = 'àª–à«‹àªŸà«àª‚. âŒ àª«àª°à«€ àªªà«àª°àª¯àª¾àª¸ àª•àª°à«‹.';
                feedbackEl.classList.add('text-red-600');
            } else {
                // User is still typing (e.g., entered '1' but correct is '85') - no color feedback yet
            }
        }

        /**
         * Generates a new abacus problem.
         * @param {number} count The number of problems to generate (now fixed to 1).
         */
        function generateNewGame(count) {
            const actualCount = 1; // Force count to 1 for single problem mode
            const gameArea = document.getElementById('game-area');
            gameArea.innerHTML = ''; // Clear previous game
            correctAnswers = [];
            isAnsweredCorrectly = false; // Reset the flag
            
            document.getElementById('score-message').classList.add('hidden');
            
            // Only generate one problem
            for (let i = 0; i < actualCount; i++) {
                // Generate a random two-digit number (10 to 99)
                const number = getRandomInt(10, 99);
                correctAnswers.push(number);
                
                const problemHtml = createAbacusProblem(number, i);
                gameArea.insertAdjacentHTML('beforeend', problemHtml);
            }

            // Focus on the input field for immediate playability
            const inputField = document.getElementById('input-0');
            if(inputField) {
                inputField.focus();
            }
        }

        // Initialize the game when the page loads
        window.onload = () => generateNewGame(1); 
    </script>
</body>
</html>
