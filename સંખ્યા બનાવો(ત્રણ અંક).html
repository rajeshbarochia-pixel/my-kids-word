<!DOCTYPE html>
<html lang="gu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>àª²àª•à«€ àª¨àª‚àª¬àª° àªµà«àª¹à«€àª² - Lucky Wheel</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rasa:wght@400;700&display=swap');

        :root {
            --c1: #FF4757; /* àªàª•àª® */
            --c2: #2ED573; /* àª¦àª¶àª• */
            --c3: #1E90FF; /* àª¸à«‹ */
            --bg: #f7f9fc;
            --text: #2f3542;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Rasa', serif;
            background-color: var(--bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            height: 100vh;
            height: -webkit-fill-available;
            overflow: hidden; /* àª¸à«àª•à«àª°à«‹àª² àª…àªŸàª•àª¾àªµàªµàª¾ àª®àª¾àªŸà«‡ */
            padding: 10px 0;
        }

        header {
            text-align: center;
            flex-shrink: 0;
        }

        h1 {
            color: var(--text);
            font-size: clamp(1.5rem, 5vh, 2.2rem);
            margin-bottom: 2px;
        }

        .author-text {
            font-family: sans-serif;
            color: #747d8c;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* Responsive Game Container */
        .game-wrapper {
            position: relative;
            width: min(85vw, 320px);
            height: min(85vw, 320px);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-shrink: 1; /* àª¸à«àª•à«àª°à«€àª¨ àª¨àª¾àª¨à«€ àª¹à«‹àª¯ àª¤à«‹ àª¸àª‚àª•à«‹àªšàª¾àª¯ */
        }

        .indicator-box {
            position: absolute;
            width: 44px;
            height: 48%; 
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid var(--text);
            border-bottom: none;
            z-index: 10;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -100%);
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            pointer-events: none;
        }

        .arrow {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.8rem;
            color: var(--text);
            z-index: 20;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-5px); }
        }

        .ring {
            position: absolute;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: transform 2.5s cubic-bezier(0.1, 0.8, 0.1, 1);
            border: 2.5px solid white;
        }

        /* Dynamic Sizes using percentages of the container */
        .ring-3 { width: 100%; height: 100%; background-color: var(--c3); z-index: 1; }
        .ring-2 { width: 68%; height: 68%; background-color: var(--c2); z-index: 2; }
        .ring-1 { width: 36%; height: 36%; background-color: var(--c1); z-index: 3; }

        .num-wrapper {
            position: absolute;
            width: 26px;
            height: 26px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .num-content {
            font-size: clamp(1rem, 4vw, 1.4rem);
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
            transition: transform 2.5s cubic-bezier(0.1, 0.8, 0.1, 1);
        }

        .ring-1 .num-content { font-size: clamp(0.8rem, 3.5vw, 1.1rem); }

        .hub {
            position: absolute;
            width: 15px;
            height: 15px;
            background: #fff;
            border-radius: 50%;
            z-index: 20;
        }

        /* Animation States */
        .spinning .ring-1 { animation: rotate-ccw 0.8s linear infinite; }
        .spinning .ring-2 { animation: rotate-cw 1.2s linear infinite; }
        .spinning .ring-3 { animation: rotate-ccw 1.6s linear infinite; }

        @keyframes rotate-cw { 100% { transform: rotate(360deg); } }
        @keyframes rotate-ccw { 100% { transform: rotate(-360deg); } }

        /* Results & Controls */
        .bottom-ui {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            padding-bottom: 20px;
            flex-shrink: 0;
        }

        .result-card {
            background: white;
            padding: 8px 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            width: 85%;
            max-width: 300px;
        }

        .result-title { font-size: 0.85rem; color: #a4b0be; font-weight: bold; }
        .result-value { font-size: 2.2rem; color: var(--text); font-weight: bold; letter-spacing: 6px; line-height: 1.1; }
        .result-words { font-size: 1.1rem; color: #57606f; min-height: 1.4rem; font-weight: 500; }

        button {
            width: 80%;
            max-width: 250px;
            padding: 12px 0;
            font-size: 1.4rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Rasa', serif;
            font-weight: bold;
            color: white;
            background-color: #2ED573;
            box-shadow: 0 4px 0 #26af5f;
            transition: all 0.1s;
        }

        button:active { transform: translateY(3px); box-shadow: none; }
        button.btn-stop { background-color: #FF4757; box-shadow: 0 4px 0 #d63d4a; }
        button:disabled { background-color: #ccc; box-shadow: none; opacity: 0.6; }

        #confetti-canvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 100;
        }

        /* Adjustments for ultra-small screens */
        @media (max-height: 550px) {
            h1 { font-size: 1.2rem; }
            .game-wrapper { width: 220px; height: 220px; }
            .result-value { font-size: 1.8rem; }
            button { padding: 8px 0; font-size: 1.1rem; }
            .bottom-ui { gap: 5px; padding-bottom: 10px; }
        }
    </style>
</head>
<body>

    <header>
        <h1>ğŸ¡ àª²àª•à«€ àª¨àª‚àª¬àª° àªµà«àª¹à«€àª² ğŸ¡</h1>
        <div class="author-text">Rajesh Barochia</div>
    </header>

    <div class="game-wrapper" id="gameWrapper">
        <div class="indicator-box"></div>
        <div class="arrow">ğŸ”»</div>

        <div class="ring ring-3" id="ring3"></div>
        <div class="ring ring-2" id="ring2"></div>
        <div class="ring ring-1" id="ring1"></div>
        
        <div class="hub"></div>
    </div>

    <div class="bottom-ui">
        <div class="result-card">
            <div class="result-title">àª¤àª®àª¾àª°à«‹ àª¨àª‚àª¬àª°:</div>
            <div class="result-value" id="resultDisplay">---</div>
            <div class="result-words" id="resultWords"></div>
        </div>

        <button id="toggleBtn" onclick="toggleSpin()">ğŸš€ àª«à«‡àª°àªµà«‹</button>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <script>
        const digits = ['à«¦', 'à«§', 'à«¨', 'à«©', 'à«ª', 'à««', 'à«¬', 'à«­', 'à«®', 'à«¯'];
        const fullNumbers = {
            1: "àªàª•", 2: "àª¬à«‡", 3: "àª¤à«àª°àª£", 4: "àªšàª¾àª°", 5: "àªªàª¾àª‚àªš", 6: "àª›", 7: "àª¸àª¾àª¤", 8: "àª†àª ", 9: "àª¨àªµ", 10: "àª¦àª¸",
            11: "àª…àª—àª¿àª¯àª¾àª°", 12: "àª¬àª¾àª°", 13: "àª¤à«‡àª°", 14: "àªšà«Œàª¦", 15: "àªªàª‚àª¦àª°", 16: "àª¸à«‹àª³", 17: "àª¸àª¤à«àª¤àª°", 18: "àª…àª¢àª¾àª°", 19: "àª“àª—àª£à«€àª¸", 20: "àªµà«€àª¸",
            21: "àªàª•àªµà«€àª¸", 22: "àª¬àª¾àªµà«€àª¸", 23: "àª¤à«àª°à«‡àªµà«€àª¸", 24: "àªšà«‹àªµà«€àª¸", 25: "àªªàªšà«€àª¸", 26: "àª›àªµà«àªµà«€àª¸", 27: "àª¸àª¤à«àª¤àª¾àªµà«€àª¸", 28: "àª…àª à«àª àª¾àªµà«€àª¸", 29: "àª“àª—àª£àª¤à«àª°à«€àª¸", 30: "àª¤à«àª°à«€àª¸",
            31: "àªàª•àª¤à«àª°à«€àª¸", 32: "àª¬àª¤à«àª°à«€àª¸", 33: "àª¤à«‡àª‚àª¤à«àª°à«€àª¸", 34: "àªšà«‹àª¤à«àª°à«€àª¸", 35: "àªªàª¾àª‚àª¤à«àª°à«€àª¸", 36: "àª›àª¤à«àª°à«€àª¸", 37: "àª¸àª¾àª¡àª¤à«àª°à«€àª¸", 38: "àª†àª¡àª¤à«àª°à«€àª¸", 39: "àª“àª—àª£àªšàª¾àª²à«€àª¸", 40: "àªšàª¾àª²à«€àª¸",
            41: "àªàª•àª¤àª¾àª²à«€àª¸", 42: "àª¬à«‡àª¤àª¾àª²à«€àª¸", 43: "àª¤àª¾àª²à«€àª¸", 44: "àªšà«àª‚àª®àª¾àª²à«€àª¸", 45: "àªªàª¿àª¸à«àª¤àª¾àª²à«€àª¸", 46: "àª›à«‡àª¤àª¾àª²à«€àª¸", 47: "àª¸à«àª¡àª¤àª¾àª²à«€àª¸", 48: "àª…àª¡àª¤àª¾àª²à«€àª¸", 49: "àª“àª—àª£àªªàªšàª¾àª¸", 50: "àªªàªšàª¾àª¸",
            51: "àªàª•àª¾àªµàª¨", 52: "àª¬àª¾àªµàª¨", 53: "àª¤à«àª°à«‡àªªàª¨", 54: "àªšà«‹àªªàª¨", 55: "àªªàª‚àªšàª¾àªµàª¨", 56: "àª›àªªà«àªªàª¨", 57: "àª¸àª¤à«àª¤àª¾àªµàª¨", 58: "àª…àª à«àª àª¾àªµàª¨", 59: "àª“àª—àª£àª¸àª¾àª ", 60: "àª¸àª¾àª ",
            61: "àªàª•àª¸àª ", 62: "àª¬àª¾àª¸àª ", 63: "àª¤à«àª°à«‡àª¸àª ", 64: "àªšà«‹àª¸àª ", 65: "àªªàª¾àª¸àª ", 66: "àª›àª¾àª¸àª ", 67: "àª¸àª¡àª¸àª ", 68: "àª…àª¡àª¸àª ", 69: "àª“àª—àª£àª¸àª¿àª¤à«àª¤à«‡àª°", 70: "àª¸àª¿àª¤à«àª¤à«‡àª°",
            71: "àªàª•à«‹àª¤à«‡àª°", 72: "àª¬àª¹à«‹àª¤à«‡àª°", 73: "àª¤à«‹àª¤à«‡àª°", 74: "àªšà«àª®à«‹àª¤à«‡àª°", 75: "àªªàª‚àªšà«‹àª¤à«‡àª°", 76: "àª›à«‹àª¤à«‡àª°", 77: "àª¸àª¿àª¤à«àª¤à«‹àª¤à«‡àª°", 78: "àª‡àª à«àª à«‹àª¤à«‡àª°", 79: "àª“àª—àª£àªàª‚àª¸à«€", 80: "àªàª‚àª¸à«€",
            81: "àªàª•à«àª¯àª¾àª¸à«€", 82: "àª¬à«àª¯àª¾àª¸à«€", 83: "àª¤à«àª¯àª¾àª¸à«€", 84: "àªšà«‹àª°à«àª¯àª¾àª¸à«€", 85: "àªªàª‚àªšàª¾àª¸à«€", 86: "àª›à«àª¯àª¾àª¸à«€", 87: "àª¸àª¤à«àª¯àª¾àª¸à«€", 88: "àª…àª à«àª¯àª¾àª¸à«€", 89: "àª“àª—àª£àª¨à«‡àªµà«àª‚", 90: "àª¨à«‡àªµà«àª‚",
            91: "àªàª•à«àª¯àª¾àª£à«àª‚", 92: "àª¬àª¾àª£à«àª‚", 93: "àª¤à«àª°àª¾àª£à«àª‚", 94: "àªšà«‹àª°àª¾àª£à«àª‚", 95: "àªªàª‚àªšàª¾àª£à«àª‚", 96: "àª›àª¨à«àª¨à«àª‚", 97: "àª¸àª¤à«àª¤àª¾àª£à«àª‚", 98: "àª…àª à«àª àª¾àª£à«àª‚", 99: "àª¨àªµà«àªµàª¾àª£à«àª‚"
        };

        const rings = [
            { id: 'ring1', radiusPercent: 18, el: null },
            { id: 'ring2', radiusPercent: 34, el: null },
            { id: 'ring3', radiusPercent: 50, el: null }
        ];

        let isSpinning = false;
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function getGujaratiWords(n) {
            if (n === 0) return "àª¶à«‚àª¨à«àª¯";
            let parts = [];
            let s = Math.floor(n / 100);
            if (s > 0) {
                if (s === 1) parts.push("àªàª•àª¸à«‹");
                else if (s === 2) parts.push("àª¬àª¸à«‹");
                else {
                    const unitNames = ["", "àªàª•", "àª¬à«‡", "àª¤à«àª°àª£", "àªšàª¾àª°", "àªªàª¾àª‚àªš", "àª›", "àª¸àª¾àª¤", "àª†àª ", "àª¨àªµ"];
                    parts.push(unitNames[s] + "àª¸à«‹");
                }
            }
            let lastTwo = n % 100;
            if (lastTwo > 0) parts.push(fullNumbers[lastTwo]);
            return parts.join(" ");
        }

        function playTone(freq, duration) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.frequency.value = freq;
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        function init() {
            const wrapperSize = document.getElementById('gameWrapper').offsetWidth;
            rings.forEach(ring => {
                ring.el = document.getElementById(ring.id);
                const radius = (wrapperSize * ring.radiusPercent) / 100;
                for (let i = 0; i < 10; i++) {
                    const div = document.createElement('div');
                    div.className = 'num-wrapper';
                    const content = document.createElement('div');
                    content.className = 'num-content';
                    content.innerText = digits[i];
                    const angle = (i * 36 - 90) * (Math.PI / 180);
                    // Adjust position slightly inward to stay within ring
                    const x = (radius - 12) * Math.cos(angle);
                    const y = (radius - 12) * Math.sin(angle);
                    div.style.transform = `translate(${x}px, ${y}px)`;
                    div.appendChild(content);
                    ring.el.appendChild(div);
                }
            });
        }

        function toggleSpin() {
            const btn = document.getElementById('toggleBtn');
            const resVal = document.getElementById('resultDisplay');
            const resWords = document.getElementById('resultWords');

            if (!isSpinning) {
                isSpinning = true;
                btn.innerText = "ğŸ›‘ àª¥à«‹àª­à«‹";
                btn.classList.add('btn-stop');
                document.getElementById('gameWrapper').classList.add('spinning');
                resVal.innerText = "---";
                resWords.innerText = "";
                rings.forEach(r => {
                    r.el.style.transform = '';
                    Array.from(r.el.getElementsByClassName('num-content')).forEach(c => c.style.transform = '');
                });
                playTone(400, 0.1);
            } else {
                isSpinning = false;
                btn.disabled = true;
                document.getElementById('gameWrapper').classList.remove('spinning');

                let wins = [];
                rings.forEach((ring, idx) => {
                    const win = Math.floor(Math.random() * 10);
                    wins.push(win);
                    const totalRotation = -1 * (win * 36) - (1080 + (idx * 360));
                    ring.el.style.transform = `rotate(${totalRotation}deg)`;
                    const counter = -totalRotation;
                    Array.from(ring.el.getElementsByClassName('num-content')).forEach(num => {
                        num.style.transform = `rotate(${counter}deg)`;
                    });
                });

                const totalVal = wins[2]*100 + wins[1]*10 + wins[0];
                const displayStr = digits[wins[2]] + digits[wins[1]] + digits[wins[0]];
                const words = getGujaratiWords(totalVal);

                setTimeout(() => {
                    resVal.innerText = displayStr;
                    resWords.innerText = words;
                    btn.disabled = false;
                    btn.innerText = "ğŸš€ àª«à«‡àª°àªµà«‹";
                    btn.classList.remove('btn-stop');
                    playTone(600, 0.4);
                    speak(words);
                    fireConfetti();
                }, 2600);
            }
        }

        function speak(text) {
            window.speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance("àª¤àª®àª¾àª°à«‹ àª¨àª‚àª¬àª° àª›à«‡, " + text);
            msg.lang = 'gu-IN';
            msg.rate = 0.85;
            window.speechSynthesis.speak(msg);
        }

        function fireConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            let p = [];
            for(let i=0; i<60; i++) {
                p.push({
                    x: canvas.width/2, y: canvas.height/2,
                    vx: (Math.random()-0.5)*10, vy: (Math.random()-0.5)*10 - 4,
                    c: `hsl(${Math.random()*360}, 70%, 50%)`, l: 80
                });
            }
            function frame() {
                ctx.clearRect(0,0,canvas.width, canvas.height);
                p.forEach((item, i) => {
                    item.x += item.vx; item.y += item.vy; item.vy += 0.3; item.l--;
                    ctx.fillStyle = item.c; ctx.beginPath();
                    ctx.arc(item.x, item.y, 4, 0, 7); ctx.fill();
                    if(item.l <= 0) p.splice(i, 1);
                });
                if(p.length > 0) requestAnimationFrame(frame);
            }
            frame();
        }

        window.onload = init;
    </script>
</body>
</html>
