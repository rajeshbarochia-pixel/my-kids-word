<!doctype html>
<html lang="gu">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ркмрк╛рк│ркХрлЛ ркорк╛ркЯрлЗ рк╕рлНрккрк┐рки рк╡рлНрк╣рлАрк▓</title>
<style>
  :root{
    --bg:#f6f9fc; --card:#fff; --accent:#2b6cb0; --muted:#666;
  }
  *{box-sizing:border-box}
  body{font-family:Inter,system-ui,Segoe UI,Arial; margin:0; background:var(--bg); color:#111; padding:20px;}
  .wrap{max-width:600px;margin:0 auto;align-items:start}
  header{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
  header h1{font-size:18px;margin:0}
  .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(20,20,40,.06)}
  #wheelCanvas{width:100%;height:auto;border-radius:8px;display:block;background:linear-gradient(180deg,#fff,#f3f6fb)}
  .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;justify-content:center}
  button{background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:8px;cursor:pointer}
  button.ghost{background:transparent;color:var(--accent);border:1px solid #d0d8e6}
  button:disabled{opacity:0.5;cursor:not-allowed}
  .result{margin-top:10px;padding:8px;border-radius:8px;background:#f0fff4;color:#064e3b;border:1px solid #dcfce7;text-align:center}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ркмрк╛рк│ркХрлЛ ркорк╛ркЯрлЗ рк╕рлНрккрк┐рки рк╡рлНрк╣рлАрк▓ ЁЯОб</h1>
    </header>

    <div class="card">
      <canvas id="wheelCanvas" width="800" height="800" role="img" aria-label="рк╕рлНрккрк┐рки рк╡рлНрк╣рлАрк▓"></canvas>

      <div class="controls">
        <button id="spinBtn">SPIN</button>
        <button id="quickSpin">Quick Spin</button>
        <button id="stopBtn" class="ghost" disabled>STOP</button>
      </div>

      <div id="resultBox" class="result" style="display:none" aria-live="polite"></div>
    </div>
  </div>

<script>
// рлзрлз ркерлА рлирлж ркЕркВркХрлЛ
const defaultItems = ["рлзрлз", "рлзрли", "рлзрлй", "рлзрлк", "рлзрлл", "рлзрлм", "рлзрлн", "рлзрло", "рлзрлп", "рлирлж"];
let items = defaultItems.slice();
let colors = [];
let isSpinning = false, angularVelocity = 0, angle = 0;
let animationId = null;
let stopRequested = false;

// рк╡рлНрк╣рлАрк▓ рк╕рлЗркЯркЕркк
const canvas = document.getElementById('wheelCanvas');
const ctx = canvas.getContext('2d');
let cw = canvas.width, ch = canvas.height;
let cx = cw/2, cy = ch/2, radius = Math.min(cw,ch)*0.42;

// рк░ркВркЧ ркЬркирк░рлЗркЯрк░
function genColor(i,n){
  const hue = Math.round((i*360/n) % 360);
  return `hsl(${hue} 70% 70%)`;
}

// рк╡рлНрк╣рлАрк▓ ркжрлЛрк░рлЛ
function drawWheel(){
  ctx.clearRect(0,0,cw,ch);
  const n = items.length || 1;
  const seg = 2*Math.PI / n;
  
  // рк╕рлЗркЧркорлЗркирлНркЯрлНрк╕ ркжрлЛрк░рлЛ
  ctx.save();
  ctx.translate(cx,cy);
  ctx.rotate(angle);
  for(let i=0;i<n;i++){
    const start = i*seg;
    
    // рк╕рлЗркЧркорлЗркирлНркЯ ркмрлЗркХркЧрлНрк░рк╛ркЙркирлНркб
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.arc(0,0,radius,start,start+seg);
    ctx.closePath();
    ctx.fillStyle = colors[i] || genColor(i,n);
    ctx.fill();
    
    // рк╕рклрлЗркж ркмрлЛрк░рлНркбрк░
    ctx.strokeStyle = "#ffffff";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.lineTo(Math.cos(start)*radius, Math.sin(start)*radius);
    ctx.stroke();
  }
  
  // ркмрк╣рк╛рк░ркирлА ркмрлЛрк░рлНркбрк░
  ctx.strokeStyle = "#ffffff";
  ctx.lineWidth = 2;
  ctx.beginPath();
  ctx.arc(0,0,radius,0,2*Math.PI);
  ctx.stroke();
  ctx.restore();

  // ркЯрлЗркХрлНрк╕рлНркЯ ркжрлЛрк░рлЛ
  ctx.save();
  for(let i=0;i<n;i++){
    const start = i*seg + angle;
    const textAngle = start + seg/2;
    const textRadius = radius * 0.7;
    const textX = cx + Math.cos(textAngle) * textRadius;
    const textY = cy + Math.sin(textAngle) * textRadius;
    
    ctx.fillStyle = "#08203a";
    ctx.font = `bold ${Math.max(16, Math.floor(radius/8))}px sans-serif`;
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    
    let text = items[i] || "тАФ";
    
    ctx.fillText(text, textX, textY);
  }
  ctx.restore();

  // ркХрлЗркирлНркжрлНрк░ркорк╛ркВ ркирк╛ркирлБркВ рк╡рлНрк╣рлАрк▓ ркЕркирлЗ ркирк╛рко
  ctx.save();
  ctx.translate(cx, cy);
  
  // ркирк╛ркирлБркВ рк╡рлНрк╣рлАрк▓ ркмркирк╛рк╡рлЛ
  const smallWheelRadius = radius * 0.15;
  ctx.beginPath();
  ctx.arc(0, 0, smallWheelRadius, 0, 2 * Math.PI);
  ctx.fillStyle = "#2b6cb0";
  ctx.fill();
  
  // ркирк╛ркирк╛ рк╡рлНрк╣рлАрк▓ркирлА ркмрлЛрк░рлНркбрк░
  ctx.strokeStyle = "#ffffff";
  ctx.lineWidth = 2;
  ctx.stroke();
  
  // ркирк╛рко рк▓ркЦрлЛ
  ctx.fillStyle = "#ffffff";
  ctx.font = `bold ${Math.max(10, Math.floor(smallWheelRadius/3))}px sans-serif`;
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  
  // ркирк╛ркирк╛ рк╡рлНрк╣рлАрк▓ркорк╛ркВ ркирк╛рко рк▓ркЦрлЛ (рк▓рк╛ркЗрки ркмрлНрк░рлЗркХ рк╕рк╛ркерлЗ)
  const nameLines = ["By", "rajesh", "barochia"];
  const lineHeight = Math.max(10, Math.floor(smallWheelRadius/3));
  
  nameLines.forEach((line, index) => {
    ctx.fillText(line, 0, (index - 1) * lineHeight);
  });
  
  ctx.restore();

  // рккрлЛркЗркирлНркЯрк░
  ctx.beginPath();
  ctx.moveTo(cx + radius + 12, cy);
  ctx.lineTo(cx + radius + 46, cy - 18);
  ctx.lineTo(cx + radius + 46, cy + 18);
  ctx.closePath();
  ctx.fillStyle = "#ff3b30";
  ctx.fill();
}

// ркПркирк┐ркорлЗрк╢рки рк▓рлВркк
function animate(){
  if(!isSpinning){
    cancelAnimationFrame(animationId);
    animationId = null;
    return;
  }
  
  // ркЬрлЛ рк╕рлНркЯрлЛркк рк░рк┐ркХрлНрк╡рлЗрк╕рлНркЯ ркХрк░рк╡рк╛ркорк╛ркВ ркЖрк╡рлА рк╣рлЛркп ркдрлЛ ркЭркбрккркерлА ркзрлАркорлБркВ рккрк╛ркбрлЛ
  if(stopRequested){
    angularVelocity *= 0.7; // ркЦрлВркм ркЬ ркЭркбрккркерлА ркзрлАркорлБркВ рккрк╛ркбрлЛ
    
    if(Math.abs(angularVelocity) < 0.001){
      isSpinning = false;
      stopRequested = false;
      finishSpin();
      return;
    }
  } else {
    // рк╕рк╛ркорк╛ркирлНркп рклрлНрк░рк┐ркХрлНрк╢рки
    angularVelocity *= 0.995;
  }
  
  angle += angularVelocity;
  
  if(Math.abs(angularVelocity) < 0.0005 && !stopRequested){
    isSpinning = false;
    finishSpin();
  } else {
    animationId = requestAnimationFrame(animate);
  }
  drawWheel();
}

// рк╕рлНрккрк┐рки рк╢рк░рлВ ркХрк░рлЛ
function startSpin(forceFast){
  if(isSpinning) return;
  if(items.length === 0) return;
  
  isSpinning = true;
  stopRequested = false;
  angularVelocity = (Math.PI/30) * (forceFast ? (6 + Math.random()*6) : (3 + Math.random()*4));
  if(Math.random() < 0.5) angularVelocity = -angularVelocity;
  
  // рк╕рлНркЯрлЛркк ркмркЯрки ркПркирлЗркмрк▓ ркХрк░рлЛ
  document.getElementById('stopBtn').disabled = false;
  document.getElementById('spinBtn').disabled = true;
  document.getElementById('quickSpin').disabled = true;
  
  // рк░рк┐рк╕рк▓рлНркЯ ркмрлЛркХрлНрк╕ ркЫрлБрккрк╛рк╡рлЛ
  document.getElementById('resultBox').style.display = "none";
  
  animate();
}

// рк╕рлНрккрк┐рки ркЕркЯркХрк╛рк╡рлЛ
function stopSpin(){
  if(!isSpinning || stopRequested) return;
  
  stopRequested = true;
  
  // рк╕рлНркЯрлЛркк ркмркЯрки ркбрк┐рк╕рлЗркмрк▓ ркХрк░рлЛ
  document.getElementById('stopBtn').disabled = true;
}

// рккрк░рк┐ркгрк╛рко ркмркдрк╛рк╡рлЛ
const resultBox = document.getElementById('resultBox');
function finishSpin(){
  const n = items.length;
  const seg = 2*Math.PI / n;
  let raw = (-angle) / seg;
  let idx = Math.floor(raw) % n;
  if(idx < 0) idx += n;
  const winner = items[idx] || "тАФ";
  
  resultBox.style.display = "block";
  resultBox.textContent = `ЁЯОЙ Result: ${winner}`;
  
  // ркмркЯркирлНрк╕ рк░рлАрк╕рлЗркЯ ркХрк░рлЛ
  document.getElementById('stopBtn').disabled = true;
  document.getElementById('spinBtn').disabled = false;
  document.getElementById('quickSpin').disabled = false;
  
  // ркХркирлНрклрлЗркЯрлНркЯрлА
  try{ 
    if(window.confetti){
      window.confetti({particleCount:80, spread:70});
    }
  }catch(e){}
}

// рк░ркВркЧрлЛ ркЗркирк┐рк╢рк┐ркпрк▓рк╛ркЗркЭ ркХрк░рлЛ
function ensureColors(){
  colors = [];
  for(let i=0;i<items.length;i++){
    colors[i] = genColor(i, items.length);
  }
}

// ркЗрк╡рлЗркирлНркЯ рк▓рк┐рк╕рлНркЯркирк░рлНрк╕
document.getElementById('spinBtn').addEventListener('click', ()=>startSpin(false));
document.getElementById('quickSpin').addEventListener('click', ()=>startSpin(true));
document.getElementById('stopBtn').addEventListener('click', stopSpin);

// ркХрлАркмрлЛрк░рлНркб ркПркХрлНрк╕рлЗрк╕рк┐ркмрк┐рк▓рк┐ркЯрлА
document.addEventListener('keydown', e=>{
  if(e.key === ' ' || e.key === 'Enter'){
    const active = document.activeElement;
    if(active && (active.tagName === 'INPUT' || active.tagName === 'TEXTAREA')) return;
    e.preventDefault();
    startSpin(false);
  }
});

// рк╡рк┐ркирлНркбрлЛ рк░рлАрк╕рк╛ркЗркЭ
function resizeCanvas(){
  const rect = canvas.getBoundingClientRect();
  const ratio = window.devicePixelRatio || 1;
  canvas.width = Math.floor(rect.width * ratio);
  canvas.height = Math.floor(rect.width * ratio);
  cw = canvas.width; ch = canvas.height; 
  cx = cw/2; cy = ch/2; 
  radius = Math.min(cw,ch)*0.42;
  drawWheel();
}

// ркХркирлНрклрлЗркЯрлНркЯрлА рк▓рк╛ркЗркмрлНрк░рлЗрк░рлА
(function loadConfetti(){
  const s = document.createElement('script');
  s.src = 'https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js';
  document.head.appendChild(s);
})();

// рк╢рк░рлВркЖркд
function init(){
  ensureColors();
  resizeCanvas();
  drawWheel();
}

// рккрлЗркЬ рк▓рлЛркб ркеркпрлЗрк▓ рк╣рлЛркп ркдрлНркпрк╛рк░рлЗ ркЗркирк┐рк╢рк┐ркпрк▓рк╛ркЗркЭ ркХрк░рлЛ
if(document.readyState === 'loading'){
  document.addEventListener('DOMContentLoaded', init);
} else {
  init();
}

window.addEventListener('resize', resizeCanvas);

</script>
</body>
</html>