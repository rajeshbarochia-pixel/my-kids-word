<!DOCTYPE html>
<html lang="gu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>рк▓ркВркмрк╛ркИ ркорк╛рккрк╡рк╛ркирлА рк░ркоркд</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font (Inter is good for readability) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the pencil and ruler */
        :root {
            --unit-scale: 30px; /* 1 unit = 30 pixels on screen */
            font-family: 'Inter', sans-serif;
        }
        
        /* Ruler Mark Styles */
        .ruler-mark {
            width: 1px;
            background-color: #374151; /* Darker mark color */
            position: absolute;
            bottom: 0;
            z-index: 10;
        }
        .large-mark { height: 18px; background-color: #1f2937; } /* Full unit marks are thicker and longer */
        .medium-mark { height: 12px; } /* Half unit marks */
        .small-mark { height: 8px; background-color: #6b7280; } /* Tenth unit marks are lighter and smaller */

        /* Pencil Tip Style */
        .pencil-tip {
            width: 0;
            height: 0;
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-left-width: var(--unit-scale);
            border-left-style: solid;
            position: absolute;
            right: calc(-1 * var(--unit-scale)); 
            top: 50%;
            transform: translateY(-50%);
            z-index: 5;
            filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.1));
        }
        
        /* Pencil Body Style */
        #pencil {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2), inset 0 0 10px rgba(255, 255, 255, 0.3); /* Enhanced shadow for 3D effect */
            transition: all 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* Smoother transition */
        }

        /* Ruler Area Styling */
        #ruler-area {
            background-color: #f3f4f6; /* Light grey background for the ruler area */
            border-radius: 8px;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1); /* Slight inner shadow */
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

    <div id="game-container" class="w-full max-w-lg bg-white rounded-xl shadow-2xl p-6 md:p-8 space-y-6">

        <!-- Title and Creator -->
        <header class="text-center border-b pb-4">
            <h1 class="text-3xl font-extrabold text-blue-700 mb-2">
                ЁЯУП рк▓ркВркмрк╛ркИ ркорк╛рккрк╡рк╛ркирлА рк░ркоркд
            </h1>
            <p class="text-sm text-gray-500">Created by: Rajesh Barochia</p>
        </header>

        <!-- Game Area -->
        <main class="space-y-6">
            <p id="instruction" class="text-xl font-semibold text-gray-800 text-center">
                рккрлЗркирлНрк╕рк┐рк▓ркирлА рк▓ркВркмрк╛ркИ ркХрлЗркЯрк▓рлА ркЫрлЗ? (рк╕рлЗ.ркорлА. ркорк╛ркВ)
            </p>

            <!-- Ruler and Pencil Visualization (Enhanced) -->
            <div id="ruler-area" class="relative overflow-x-scroll pt-4 pb-8 border-b border-gray-300">
                <div id="ruler-line" class="absolute bottom-1 w-full h-1 bg-gray-400"></div>
                
                <!-- Ruler Marks and Labels (Dynamically Generated) -->
                <div id="ruler-container" class="relative" style="height: 40px; min-width: 160%;">
                    <!-- Pencil will be rendered here -->
                    <div id="pencil" class="absolute top-1/2 -translate-y-1/2 h-5 rounded-full" style="left: 0; background-color: #ef4444;">
                        <div id="pencil-tip" class="pencil-tip" style="border-left-color: #dc2626;"></div>
                    </div>
                </div>
            </div>

            <!-- Input and Check Button -->
            <div class="flex flex-col space-y-4">
                <input type="number" id="answer-input" placeholder="ркдркорк╛рк░рлЛ ркЬрк╡рк╛ркм рк▓ркЦрлЛ (cm ркорк╛ркВ)"
                       class="w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-4 focus:ring-blue-500/50 transition-colors"
                       onkeydown="if(event.key === 'Enter') checkAnswer()" step="0.5">
                
                <button onclick="checkAnswer()" id="check-button"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-lg transition-transform transform hover:scale-[1.01] active:scale-95 text-lg">
                    ркЬрк╡рк╛ркм ркЪркХрк╛рк╕рлЛ
                </button>
            </div>

            <!-- Feedback Message Area -->
            <div id="feedback-message" class="text-center font-semibold h-6"></div>

            <!-- Next Question Button (Hidden initially) -->
            <button onclick="nextProblem()" id="next-button"
                    class="hidden w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg shadow-lg transition-transform transform hover:scale-[1.01] active:scale-95 text-lg">
                ркЖркЧрк│ркирлЛ рккрлНрк░рк╢рлНрки
            </button>
        </main>

    </div>

    <script>
        const answerInput = document.getElementById('answer-input');
        const checkButton = document.getElementById('check-button');
        const nextButton = document.getElementById('next-button');
        const feedbackMessage = document.getElementById('feedback-message');
        const pencilElement = document.getElementById('pencil');
        const pencilTipElement = document.getElementById('pencil-tip');
        const rulerContainer = document.getElementById('ruler-container');

        let correctAnswer = 0;
        const UNIT_SCALE = 30; // Pixels per unit (ркорк╛рккрккркЯрлНркЯрлАркирлА ркжрлНрк░рк╢рлНркп рк╕рлНркХрлЗрк▓)
        const MAX_LENGTH = 15; // ркорк╛рккрккркЯрлНркЯрлАркирлА ркорк╣ркдрлНркдрко рк▓ркВркмрк╛ркИ рк╣рк╡рлЗ 15 ркпрлБркирк┐ркЯрлНрк╕ ркЫрлЗ

        /**
         * Converts a random hex color to a darker shade for the tip.
         * @param {string} hex - The base hex color (e.g., #ff0000).
         * @returns {string} - The darker hex color.
         */
        function darkenColor(hex, percent) {
            let r = parseInt(hex.substring(1, 3), 16);
            let g = parseInt(hex.substring(3, 5), 16);
            let b = parseInt(hex.substring(5, 7), 16);

            r = parseInt(r * (100 - percent) / 100);
            g = parseInt(g * (100 - percent) / 100);
            b = parseInt(b * (100 - percent) / 100);

            r = (r < 255) ? r : 255;
            g = (g < 255) ? g : 255;
            b = (b < 255) ? b : 255;

            return '#' + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }

        /**
         * Renders the ruler marks and labels based on the MAX_LENGTH, including sub-units.
         */
        function renderRuler() {
            // Only render once
            if (rulerContainer.querySelector('.ruler-mark')) return;

            // Calculate the total width of the ruler area needed
            const rulerWidth = MAX_LENGTH * UNIT_SCALE;
            rulerContainer.style.width = `${rulerWidth + UNIT_SCALE}px`;

            // Loop through every 0.1 unit to draw small marks
            for (let i = 0; i <= MAX_LENGTH; i = Math.round((i + 0.1) * 10) / 10) {
                const mark = document.createElement('div');
                mark.classList.add('ruler-mark');
                mark.style.left = `${i * UNIT_SCALE}px`;

                if (i % 1 === 0) {
                    // Full unit mark (e.g., 0, 1, 2, ...)
                    mark.classList.add('large-mark');
                    const label = document.createElement('span');
                    label.textContent = i;
                    label.classList.add('absolute', 'bottom-5', 'text-sm', 'font-bold', 'text-gray-900', 'transform', '-translate-x-1/2');
                    label.style.left = `${i * UNIT_SCALE}px`;
                    rulerContainer.appendChild(label);
                } else if (Math.round((i % 1) * 10) / 10 === 0.5) {
                    // Half unit mark (e.g., 0.5, 1.5, 2.5, ...)
                    mark.classList.add('medium-mark');
                } else {
                    // Tenth unit mark (e.g., 0.1, 0.2, 0.3, ...)
                    mark.classList.add('small-mark');
                }
                rulerContainer.appendChild(mark);
            }
        }

        /**
         * Generates a new random measurement problem.
         */
        function generateProblem() {
            // Generate a random length between 3.0 and 15.0 (inclusive) in 0.5 increments.
            // Index ranges from 6 (3.0 * 2) to 30 (15.0 * 2).
            const minIndex = 3 * 2; // 6
            const maxIndex = MAX_LENGTH * 2; // 30
            const randomIndex = Math.floor(Math.random() * (maxIndex - minIndex + 1)) + minIndex; 
            correctAnswer = randomIndex / 2; // e.g., 7 / 2 = 3.5

            // Generate a random bright color for the pencil
            const randomColor = `#${Math.floor(Math.random()*16777215).toString(16).padStart(6, '0')}`;
            const tipColor = darkenColor(randomColor, 30); // Darken by 30% for the tip

            // Calculate the width for the colored body (correctAnswer - 1 unit)
            // Note: pencil tip is always 1 unit (UNIT_SCALE) wide in the visualization
            const bodyWidth = (correctAnswer - 1) * UNIT_SCALE;
            
            // Set the visual length of the pencil body
            pencilElement.style.width = `${bodyWidth}px`;
            pencilElement.style.backgroundColor = randomColor;
            
            // Set the tip color
            pencilTipElement.style.borderLeftColor = tipColor;
            
            // Update input and message state
            answerInput.value = '';
            answerInput.classList.remove('border-green-500', 'border-red-500', 'ring-green-300', 'ring-red-300');
            answerInput.classList.add('border-gray-300');
            answerInput.disabled = false;
            
            checkButton.classList.remove('hidden');
            nextButton.classList.add('hidden');
            feedbackMessage.textContent = '';
        }

        /**
         * Checks the user's answer against the correct answer.
         */
        function checkAnswer() {
            // Use parseFloat to handle decimal input
            const userAnswer = parseFloat(answerInput.value); 
            
            // Clear previous feedback classes
            answerInput.classList.remove('border-green-500', 'border-red-500', 'border-gray-300', 'ring-green-300', 'ring-red-300');
            answerInput.classList.add('border-2');

            if (isNaN(userAnswer)) {
                feedbackMessage.textContent = 'ркХрлГрккрк╛ ркХрк░рлАркирлЗ ркЕркВркХ (ркжрк╛.ркд. 5.5) ркжрк╛ркЦрк▓ ркХрк░рлЛ.';
                feedbackMessage.classList.remove('text-green-600');
                feedbackMessage.classList.add('text-red-600');
                answerInput.classList.add('border-red-500');
                return;
            }

            // Compare the float values
            if (userAnswer === correctAnswer) { 
                // Correct Answer: turn box green
                answerInput.classList.add('border-green-500', 'ring-4', 'ring-green-300/50');
                feedbackMessage.textContent = 'тЬЕ рк╕рк╛ркЪрлЛ ркЬрк╡рк╛ркм! рк╢рк╛ркмрк╛рк╢.';
                feedbackMessage.classList.remove('text-red-600');
                feedbackMessage.classList.add('text-green-600');
                
                // Disable input and show next button
                answerInput.disabled = true;
                checkButton.classList.add('hidden');
                nextButton.classList.remove('hidden');
            } else {
                // Incorrect Answer: turn box red
                answerInput.classList.add('border-red-500', 'ring-4', 'ring-red-300/50');
                feedbackMessage.textContent = `тЭМ ркЦрлЛркЯрлЛ ркЬрк╡рк╛ркм. рк╕рк╛ркЪрлЛ ркЬрк╡рк╛ркм ${correctAnswer.toFixed(1)} cm ркЫрлЗ. рклрк░рлА рккрлНрк░ркпрк╛рк╕ ркХрк░рлЛ.`;
                feedbackMessage.classList.remove('text-green-600');
                feedbackMessage.classList.add('text-red-600');
            }
        }

        /**
         * Starts a new game problem.
         */
        function nextProblem() {
            generateProblem();
        }

        // Initialize the game when the window loads
        window.onload = function() {
            renderRuler(); // Draw the static ruler structure
            generateProblem(); // Start the first problem
        };

    </script>

</body>
</html>
