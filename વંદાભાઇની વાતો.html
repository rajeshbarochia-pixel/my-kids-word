<!DOCTYPE html>
<html lang="gu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>рк╡ркВркжрк╛ркирлА ркЕркЬрк╛ркпркм ркжрлБркирк┐ркпрк╛ - рк╢рлИркХрлНрк╖ркгрк┐ркХ ркЧрлЗрко</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Gujarati:wght@400;700&display=swap');
        body {
            font-family: 'Noto Sans Gujarati', sans-serif;
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
        }
        .card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .btn-active:active { transform: scale(0.95); }
        .hidden { display: none; }
        .progress-bar { transition: width 0.5s ease; }
    </style>
</head>
<body class="bg-yellow-50">

    <div class="max-w-md w-full text-center space-y-4 mt-4">
        <!-- Header -->
        <div class="card p-5 border-b-8 border-orange-500 bg-white">
            <h1 class="text-3xl font-bold text-orange-800 text-center flex items-center justify-center gap-2">
                ЁЯк│ рк╡ркВркжрк╛ркнрк╛ркИркирлА рк╡рк╛ркдрлЛ ЁЯк│
            </h1>
            <p class="text-sm text-green-700 font-bold mt-1 uppercase tracking-wider">рккрк░рлНркпрк╛рк╡рк░ркгркирк╛ ркорк┐ркдрлНрк░</p>
        </div>

        <!-- Section 1: Information Area (Full Text) -->
        <div id="info-section" class="card p-6 space-y-4 animate-in fade-in">
            <div id="full-text" class="bg-yellow-50 p-4 rounded-2xl text-left text-gray-800 leading-relaxed border-2 border-yellow-200 text-md max-h-[400px] overflow-y-auto">
                ркШрк░ркорк╛ркВ ркжрлЛркбрк╛ркжрлЛркб ркХрк░ркдрк╛ рк╡ркВркжрк╛ркнрк╛ркИркирлЗ ркдрлЛ ркдркорлЗ ркЬрлЛркпрк╛ ркЬ рк╣рк╢рлЗ! ркПркоркирк╛ ркорк╛ркерлЗ <b>ркмрлЗ рк▓рк╛ркВркмрлА ркорлВркЫ</b> ркЬрлЛркИ ркЫрлЗ? ркЖрккркгрк╛ ркШрк░ркорк╛ркВ ркЬрлНркпрк╛ркВ ркнрлАркирлА ркЬркЧрлНркпрк╛ ркдрлНркпрк╛ркВ ркПркоркирлБркВ ркШрк░. рк░рк╕рлЛркбрк╛ркорк╛ркВ ркХрлЗ ркЕркирк╛ркЬ ркнрк░рлНркпрлБркВ рк╣рлЛркп ркдрлЗрк╡рк╛ ркнркВркбрк╛рк░ркорк╛ркВ рккркг ркдрлЗ рк░рк╣рлЗ ркЫрлЗ. рк╡ркВркжрк╛ркирк╛ <b>ркорлЛркВ рккрк░ ркмрлЗ ркЕркирлЗ ркХрккрк╛рк│ркорк╛ркВ ркдрлНрк░ркг</b> ркорк│рлАркирлЗ ркХрлБрк▓ <b>рлл ркЖркВркЦрлЛ</b> рк╣рлЛркп ркЫрлЗ. ркЖрккркгрлЗ ркирк╛ркХркерлА рк╕рлВркВркШрлАркП, рк╣рк╛ркеркерлА ркЕркбрлАркП, ркорлЛркВркерлА рк╡рк╛ркдрлЛ ркХрк░рлАркП; рк╡ркВркжрлЛ ркЖрк╡рк╛ркВ ркмркзрк╛ркВ ркХрк╛рко ркжрлЛрк░рк╛ ркЬрлЗрк╡рлА <b>ркорлВркЫркерлА</b> ркХрк░рлЗ. ркЦрлЛрк░рк╛ркХ рк╢рлЛркзрк╡рк╛ ркорк╛ркЯрлЗ, рк╢рк┐ркХрк╛рк░рлАркирлЗ ркжрлВрк░ рк░рк╛ркЦрк╡рк╛ ркорк╛ркЯрлЗ рк╡ркВркжрлЛ ркорлВркЫ рк╣рк▓рк╛рк╡рлЗ ркЫрлЗ. ркПркирлА <b>ркЫрк╛ркдрлА ркЦрлВркм ркЬ ркоркЬркмрлВркд</b> рк╣рлЛркп ркЫрлЗ. ркдрлЗркорк╛ркВркерлА ркирлАркХрк│рлЗ <b>ркХрк╛ркВркЯрк╛рк╡рк╛рк│рк╛ ркЫ рккркЧ</b>. рккркХрлНрк╖рлАркирлА ркЬрлЗрко ркПркоркирлЗ рккрк╛ркВркЦрлЛ ркЦрк░рлА рккркг ркдрлЗ ркмрк╣рлБ ркКркбрлА рки рк╢ркХрлЗ. рк╡ркВркжрлЛ <b>ркжрлЛркбрк╡рк╛ркорк╛ркВ ркмрк╣рлБ ркЭркбрккрлА</b>-рк░рлЗрк╕ркорк╛ркВ ркЖрккркгркирлЗ рк╣рк░рк╛рк╡рлА ркжрлЗ, рккркг ркЬрлЛ ркП ркКркВркзрлЛ рккркбрлА ркЬрк╛ркп ркдрлЛ ркЬрк╛ркдрлЗ рк╕рлАркзрлЛ рки ркеркИ рк╢ркХрлЗ. ркШрк░ркорк╛ркВ рк░рк╣рлЗ ркПркЯрк▓рлЗ ркмрлАркорк╛рк░рлА рклрлЗрк▓рк╛рк╡рлА рк╢ркХрлЗ ркЫрлЗ. ркЬрлЛркХрлЗ ркдрлЗ рккрк╛ркХркирлЗ ркирлБркХрк╕рк╛рки ркХрк░ркдрк╛ркВ ркЬркВркдрлБркУркирлЗ ркЦрк╛ркИ ркЬрк╛ркп ркЫрлЗ. ркдрлЗ ркХркЪрк░рлЛ ркЦрк╛ркИ ркЬрк╛ркп ркЫрлЗ. ркЖрко, <b>рккрк░рлНркпрк╛рк╡рк░ркгркирлЗ рк╕рлНрк╡ркЪрлНркЫ</b> рк░рк╛ркЦрк╡рк╛ркорк╛ркВ ркоркжркж ркХрк░рлЗ ркЫрлЗ.
            </div>
            <div class="flex flex-col gap-2">
                <button onclick="speakText('info')" class="w-full bg-blue-500 text-white py-3 rounded-2xl flex items-center justify-center gap-2 font-bold btn-active shadow-md">
                    <span>ЁЯФК ркорк╛рк╣рк┐ркдрлА рк╕рк╛ркВркнрк│рлЛ</span>
                </button>
                <button onclick="startQuiz()" class="w-full bg-green-600 text-white py-4 rounded-2xl text-xl font-bold btn-active shadow-xl border-b-4 border-green-800">
                    ркЪрк╛рк▓рлЛ ркЧрлЗрко рк╢рк░рлВ ркХрк░рлАркП! ЁЯЪА
                </button>
            </div>
        </div>

        <!-- Section 2: Quiz Area -->
        <div id="quiz-section" class="card p-6 space-y-6 hidden">
            <!-- Progress -->
            <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div id="progress" class="bg-orange-500 h-2.5 rounded-full progress-bar" style="width: 10%"></div>
            </div>

            <div class="flex justify-between items-center font-bold text-gray-500 px-1">
                <span id="q-counter" class="bg-orange-50 px-3 py-1 rounded-full text-orange-600">рккрлНрк░рк╢рлНрки: рлз/рлзрлж</span>
                <span id="score-counter" class="bg-green-50 px-3 py-1 rounded-full text-green-600">рк╕рлНркХрлЛрк░: рлж</span>
            </div>
            
            <div id="question-text" class="text-xl font-bold text-gray-800 py-2 min-h-[90px] flex items-center justify-center">
                ...
            </div>

            <div id="options-container" class="grid grid-cols-1 gap-3">
                <!-- Options injected here -->
            </div>

            <div id="feedback" class="h-10 font-bold text-xl text-center flex items-center justify-center"></div>
        </div>

        <!-- Section 3: Final Result -->
        <div id="result-section" class="card p-8 space-y-6 hidden text-center">
            <div id="result-emoji" class="text-8xl">ЁЯеЗ</div>
            <h2 class="text-3xl font-bold text-gray-800">рк╢рк╛ркмрк╛рк╢!</h2>
            <div class="p-6 bg-orange-50 rounded-3xl border-2 border-orange-100">
                <p id="final-score" class="text-4xl font-bold text-orange-600">рк╕рлНркХрлЛрк░: рлж/рлзрлж</p>
                <p class="text-gray-600 mt-2">ркдркорлЗ рк╡ркВркжрк╛ рк╡рк┐рк╢рлЗ ркШркгрлБркВ ркирк╡рлБркВ рк╢рлАркЦрлНркпрк╛!</p>
            </div>
            <button onclick="location.reload()" class="w-full bg-blue-600 text-white font-bold py-4 rounded-2xl text-xl shadow-lg btn-active">
                рклрк░рлАркерлА рк░ркорлЛ ЁЯФД
            </button>
        </div>

        <!-- Footer -->
        <div class="pb-6">
            <p class="text-gray-500 font-bold text-xs bg-white/50 px-4 py-1 rounded-full border border-gray-200 inline-block">Created by: Rajesh barochia</p>
        </div>
    </div>

    <!-- Audio Player -->
    <audio id="audio-player" class="hidden"></audio>

    <script>
        const apiKey = ""; 
        let currentIdx = 0;
        let score = 0;
        
        const allQuestions = [
            { q: "рк╡ркВркжрк╛ркирк╛ рк╢рк░рлАрк░ркорк╛ркВ ркХрлБрк▓ ркХрлЗркЯрк▓рлА ркЖркВркЦрлЛ рк╣рлЛркп ркЫрлЗ?", o: ["рли", "рлй", "рлл"], a: 2 },
            { q: "рк╡ркВркжрк╛ркирк╛ ркХрккрк╛рк│ркорк╛ркВ ркХрлЗркЯрк▓рлА ркЖркВркЦрлЛ рк╣рлЛркп ркЫрлЗ?", o: ["рлз", "рли", "рлй"], a: 2 },
            { q: "рк╡ркВркжрлЛ рк╕рлВркВркШрк╡рк╛ркирлБркВ ркЕркирлЗ ркЕркбрк╡рк╛ркирлБркВ ркХрк╛рко рк╢рк╛ркирк╛ркерлА ркХрк░рлЗ ркЫрлЗ?", o: ["рккркЧркерлА", "ркорлВркЫрлЛркерлА", "ркЖркВркЦрлЛркерлА"], a: 1 },
            { q: "рк╡ркВркжрк╛ркирк╛ рккркЧ ркХрлЗрк╡рк╛ рк╣рлЛркп ркЫрлЗ?", o: ["рк╕рлБрк╡рк╛рк│рк╛", "ркХрк╛ркВркЯрк╛рк╡рк╛рк│рк╛", "ркЪрлАркХркгрк╛"], a: 1 },
            { q: "ркЬрлЛ рк╡ркВркжрлЛ ркКркВркзрлЛ рккркбрлА ркЬрк╛ркп ркдрлЛ рк╢рлБркВ ркерк╛ркп?", o: ["ркдрк░ркд рк╕рлАркзрлЛ ркеркИ ркЬрк╛ркп", "ркЬрк╛ркдрлЗ рк╕рлАркзрлЛ рки ркеркИ рк╢ркХрлЗ", "ркЙркбрк╡рк╛ рк▓рк╛ркЧрлЗ"], a: 1 },
            { q: "рк╡ркВркжрлЛ ркЦрлЛрк░рк╛ркХ рк╢рлЛркзрк╡рк╛ ркорк╛ркЯрлЗ рк╢рлБркВ рк╣рк▓рк╛рк╡рлЗ ркЫрлЗ?", o: ["рккрк╛ркВркЦрлЛ", "рккркЧ", "ркорлВркЫрлЛ"], a: 2 },
            { q: "рк╡ркВркжрлЛ ркжрлЛркбрк╡рк╛ркорк╛ркВ ркХрлЗрк╡рлЛ рк╣рлЛркп ркЫрлЗ?", o: ["ркзрлАркорлЛ", "ркЦрлВркм ркЬ ркЭркбрккрлА", "рк╕рк╛ркзрк╛рк░ркг"], a: 1 },
            { q: "рк╡ркВркжрк╛ркирлЗ ркХрлБрк▓ ркХрлЗркЯрк▓рк╛ рккркЧ рк╣рлЛркп ркЫрлЗ?", o: ["рлк", "рлм", "рло"], a: 1 },
            { q: "рк╡ркВркжрлЛ рккрк░рлНркпрк╛рк╡рк░ркгркирлЗ ркХрлЗрк╡рлА рк░рлАркдрлЗ рк╕рк╛ркл рк░рк╛ркЦрлЗ ркЫрлЗ?", o: ["рккрк╛ркгрлА рккрлАркирлЗ", "ркХркЪрк░рлЛ ркЦрк╛ркИркирлЗ", "рккрк╛ркХ ркмркЧрк╛ркбрлАркирлЗ"], a: 1 },
            { q: "рк╡ркВркжрк╛ркирк╛ ркорлЛркВ рккрк░ ркХрлЗркЯрк▓рлА ркЖркВркЦрлЛ рк╣рлЛркп ркЫрлЗ?", o: ["рлз", "рли", "рлй"], a: 1 }
        ];

        let questions = [...allQuestions].sort(() => Math.random() - 0.5);

        const infoText = "ркШрк░ркорк╛ркВ ркжрлЛркбрк╛ркжрлЛркб ркХрк░ркдрк╛ рк╡ркВркжрк╛ркнрк╛ркИркирлЗ ркдрлЛ ркдркорлЗ ркЬрлЛркпрк╛ ркЬ рк╣рк╢рлЗ! ркПркоркирк╛ ркорк╛ркерлЗ ркмрлЗ рк▓рк╛ркВркмрлА ркорлВркЫ рк╣рлЛркп ркЫрлЗ. рк░рк╕рлЛркбрк╛ркорк╛ркВ ркХрлЗ ркЕркирк╛ркЬркирк╛ ркнркВркбрк╛рк░ркорк╛ркВ ркдрлЗ рк░рк╣рлЗ ркЫрлЗ. рк╡ркВркжрк╛ркирк╛ ркорлЛркВ рккрк░ ркмрлЗ ркЕркирлЗ ркХрккрк╛рк│ркорк╛ркВ ркдрлНрк░ркг ркорк│рлАркирлЗ ркХрлБрк▓ рккрк╛ркВркЪ ркЖркВркЦрлЛ рк╣рлЛркп ркЫрлЗ. ркдрлЗ рккрлЛркдрк╛ркирлА ркорлВркЫрлЛркерлА рк╕рлВркВркШрк╡рк╛ркирлБркВ ркЕркирлЗ ркЕркбрк╡рк╛ркирлБркВ ркХрк╛рко ркХрк░рлЗ ркЫрлЗ. ркдрлЗркирлЗ ркЫ ркХрк╛ркВркЯрк╛рк╡рк╛рк│рк╛ рккркЧ рк╣рлЛркп ркЫрлЗ. ркжрлЛркбрк╡рк╛ркорк╛ркВ ркдрлЗ ркЦрлВркм ркЬ ркЭркбрккрлА ркЫрлЗ. ркдрлЗ ркХркЪрк░рлЛ ркЦрк╛ркИркирлЗ рккрк░рлНркпрк╛рк╡рк░ркгркирлЗ рк╕рк╛ркл рк░рк╛ркЦрк╡рк╛ркорк╛ркВ ркоркжркж ркХрк░рлЗ ркЫрлЗ.";

        // Track the current playback to avoid AbortError
        let currentPlayPromise = null;

        async function speakText(type, customText = null) {
            const text = customText || (type === 'info' ? infoText : questions[currentIdx].q);
            const player = document.getElementById('audio-player');

            // If audio is already playing, stop it first
            if (currentPlayPromise !== null) {
                player.pause();
                player.currentTime = 0;
            }

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `ркЧрлБркЬрк░рк╛ркдрлАркорк╛ркВ рк╕рлНрккрк╖рлНркЯ ркмрлЛрк▓рлЛ: ${text}` }] }],
                        generationConfig: {
                            responseModalities: ["AUDIO"],
                            speechConfig: { voiceConfig: { prebuiltVoiceConfig: { voiceName: "Kore" } } }
                        }
                    })
                });
                
                const result = await response.json();
                if (!result.candidates || !result.candidates[0].content.parts[0].inlineData) return;
                
                const pcmData = result.candidates[0].content.parts[0].inlineData.data;
                const audioBlob = pcmToWav(pcmData, 24000);
                
                // Set the source and play
                const audioUrl = URL.createObjectURL(audioBlob);
                player.src = audioUrl;
                
                // Store the promise and handle potential aborts
                currentPlayPromise = player.play();
                
                if (currentPlayPromise !== undefined) {
                    currentPlayPromise.catch(error => {
                        if (error.name === 'AbortError') {
                            // Interrupted playback is expected when skipping fast, so we ignore this specific error
                        } else {
                            console.error("Playback error:", error);
                        }
                    });
                }
            } catch (err) { 
                console.error("Audio generation error:", err); 
            }
        }

        function pcmToWav(base64, rate) {
            const buffer = Uint8Array.from(atob(base64), c => c.charCodeAt(0)).buffer;
            const header = new ArrayBuffer(44);
            const view = new DataView(header);
            view.setUint32(0, 0x52494646, false); // "RIFF"
            view.setUint32(4, 36 + buffer.byteLength, true);
            view.setUint32(8, 0x57415645, false); // "WAVE"
            view.setUint32(12, 0x666d7420, false); // "fmt "
            view.setUint32(16, 16, true);
            view.setUint16(20, 1, true); // PCM
            view.setUint16(22, 1, true); // Mono
            view.setUint32(24, rate, true);
            view.setUint32(28, rate * 2, true);
            view.setUint16(32, 2, true);
            view.setUint16(34, 16, true);
            view.setUint32(36, 0x64617461, false); // "data"
            view.setUint32(40, buffer.byteLength, true);
            return new Blob([header, buffer], { type: 'audio/wav' });
        }

        function startQuiz() {
            document.getElementById('info-section').classList.add('hidden');
            document.getElementById('quiz-section').classList.remove('hidden');
            showQuestion();
        }

        function showQuestion() {
            const q = questions[currentIdx];
            document.getElementById('q-counter').innerText = `рккрлНрк░рк╢рлНрки: ${currentIdx + 1}/рлзрлж`;
            document.getElementById('progress').style.width = `${((currentIdx + 1) / 10) * 100}%`;
            document.getElementById('question-text').innerText = q.q;
            document.getElementById('feedback').innerText = "";
            
            const container = document.getElementById('options-container');
            container.innerHTML = "";

            q.o.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = "w-full p-4 border-2 border-gray-100 rounded-2xl text-left bg-white font-bold text-lg btn-active shadow-sm hover:border-orange-400 hover:bg-orange-50 transition-all";
                btn.innerHTML = `<span class="bg-orange-100 text-orange-600 px-3 py-1 rounded-lg mr-2 text-sm">${i+1}</span> ${opt}`;
                btn.onclick = () => check(i, btn);
                container.appendChild(btn);
            });

            speakText('quiz');
        }

        function check(i, btn) {
            const q = questions[currentIdx];
            const btns = document.querySelectorAll('#options-container button');
            btns.forEach(b => b.disabled = true);

            const feedback = document.getElementById('feedback');
            if (i === q.a) {
                score++;
                feedback.innerHTML = "рк╡рк╛рк╣! рк╕рк╛ркЪрлБркВ ркЫрлЗ ЁЯМЯ тЬЕ";
                feedback.className = "h-10 font-bold text-xl text-green-600 animate-bounce flex items-center justify-center";
                btn.classList.add('bg-green-100', 'border-green-500');
            } else {
                feedback.innerHTML = "ркЦрлЛркЯрлБркВ! рклрк░рлА рккрлНрк░ркпркдрлНрки ркХрк░ркЬрлЛ тЭМ";
                feedback.className = "h-10 font-bold text-xl text-red-600 flex items-center justify-center";
                btn.classList.add('bg-red-100', 'border-red-500');
                btns[q.a].classList.add('bg-green-50', 'border-green-300');
            }

            document.getElementById('score-counter').innerText = `рк╕рлНркХрлЛрк░: ${score}`;

            setTimeout(() => {
                currentIdx++;
                if (currentIdx < 10) showQuestion();
                else showResult();
            }, 2500);
        }

        function showResult() {
            document.getElementById('quiz-section').classList.add('hidden');
            document.getElementById('result-section').classList.remove('hidden');
            document.getElementById('final-score').innerText = `рк╕рлНркХрлЛрк░: ${score}/рлзрлж`;
            if (score >= 9) document.getElementById('result-emoji').innerText = "ЁЯПЖ";
            else if (score >= 6) document.getElementById('result-emoji').innerText = "ЁЯеИ";
            else document.getElementById('result-emoji').innerText = "ЁЯТк";
        }
    </script>
</body>
</html>